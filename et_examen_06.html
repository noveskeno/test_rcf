<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EXAMEN - PILOTO DE SEGURIDAD 05</title>
<style>
:root{--bg:#0b132b;--card:#1c2541;--accent:#5bc0be;--ok:#21c17a;--bad:#ff5d73;--text:#f5f7ff;--warning:#ffc107}
*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,system-ui,-apple-system,Roboto,Ubuntu,'Helvetica Neue',Arial,sans-serif;background:linear-gradient(135deg,var(--bg),#0f1a3a);color:var(--text);min-height:100vh;font-size:14px}
.header{padding:12px 10px;text-align:center;border-bottom:1px solid rgba(255,255,255,.08);position:sticky;top:0;background:rgba(11,19,43,.98);backdrop-filter:blur(10px);z-index:100;position:relative}
.header h1{margin:0 0 6px 0;font-size:1.2rem;font-weight:700}
.back-btn{position:absolute;left:10px;top:50%;transform:translateY(-50%);width:36px;height:36px;padding:0;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.15);border-radius:50%;color:var(--text);text-decoration:none;font-size:18px;transition:all .2s;line-height:1;display:flex;align-items:center;justify-content:center}
.back-btn:active{background:rgba(255,255,255,.15);transform:translateY(-50%) scale(.95)}
.badge{display:inline-block;padding:3px 10px;border-radius:999px;background:rgba(255,255,255,.08);font-size:11px;margin-top:4px}
.container{max-width:1000px;margin:0 auto;padding:10px 8px 100px}
.progress-bar{background:rgba(255,255,255,.1);height:3px;border-radius:999px;margin:8px 0;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--accent),#3a9d9a);width:0%;transition:width .3s ease}
.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px;margin:8px 0;box-shadow:0 4px 12px rgba(0,0,0,.2)}
.q-title{font-weight:600;margin-bottom:10px;line-height:1.4;font-size:14px}
.q-number{color:var(--accent);font-size:11px;font-weight:700;margin-bottom:6px;display:block}
.options{display:grid;grid-template-columns:1fr;gap:6px}
.option{background:#121a34;border:2px solid rgba(255,255,255,.08);padding:8px;border-radius:8px;display:flex;align-items:flex-start;gap:8px;cursor:pointer;transition:all .2s;font-size:13px;line-height:1.3}
.option:active{background:#1a2341;border-color:rgba(91,192,190,.3)}
.option input{margin-top:2px;cursor:pointer;flex-shrink:0}
.option div{flex:1}
.answer-key{display:none;margin-top:8px;padding:8px;background:rgba(91,192,190,.1);border-radius:6px;font-size:12px}
.answer-key b{color:var(--accent)}
.show-answers .answer-key{display:block}
.feedback{margin-top:6px;font-size:12px;font-weight:600;padding:6px;border-radius:4px}
.correct{border-color:rgba(33,193,122,.6)!important;background:rgba(33,193,122,.05)!important}
.incorrect{border-color:rgba(255,93,115,.75)!important;background:rgba(255,93,115,.05)!important}
.actions{position:fixed;bottom:0;left:0;right:0;background:linear-gradient(180deg,rgba(15,26,58,0),rgba(15,26,58,.99));padding:10px 8px;padding-bottom:calc(10px + env(safe-area-inset-bottom));backdrop-filter:blur(10px);border-top:1px solid rgba(255,255,255,.08);z-index:99}
.actions .bar{max-width:1000px;margin:0 auto;display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap}
button{background:var(--accent);border:none;color:#001018;font-weight:700;padding:10px 14px;border-radius:8px;cursor:pointer;transition:all .2s;font-size:13px;touch-action:manipulation}
button:active{background:var(--accent);opacity:.9;transform:scale(.98)}
button.secondary{background:transparent;border:1px solid rgba(255,255,255,.35);color:var(--text)}
button.secondary:active{background:rgba(255,255,255,.05)}
.score{font-weight:700;font-size:1rem}
.score-details{font-size:11px;color:var(--text);opacity:.8;margin-top:2px}
.footer{opacity:.8;font-size:11px;text-align:center;padding:15px;color:rgba(255,255,255,.5)}
@media (min-width: 720px){
  .options{grid-template-columns:1fr 1fr}
  body{font-size:15px}
  .card{padding:20px;margin:16px 0;border-radius:16px}
  .q-title{font-size:15px;margin-bottom:12px}
  .option{padding:12px;gap:10px;font-size:14px}
  .header{padding:20px 16px}
  .header h1{font-size:1.5rem;margin-bottom:8px}
  .container{padding:20px 16px 120px}
  button{padding:12px 18px;font-size:14px}
}
@media (max-width: 640px){
  .actions .bar{flex-direction:column;gap:6px}
  .score{text-align:center;width:100%;font-size:0.95rem}
  .actions{padding:8px 6px;padding-bottom:calc(8px + env(safe-area-inset-bottom))}
  button{width:100%;padding:11px 12px}
}
.scroll-top{position:fixed;bottom:20px;right:20px;width:40px;height:40px;background:var(--accent);color:#fff;border:none;border-radius:50%;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.2);display:flex;align-items:center;justify-content:center;font-size:20px;z-index:99;opacity:0;visibility:hidden;transition:all .3s;touch-action:manipulation}
.scroll-top.visible{opacity:1;visibility:visible}
.scroll-top:active{transform:scale(.95)}
@media (max-width:640px){
  .scroll-top{width:36px;height:36px;bottom:16px;right:16px;font-size:18px}
}
</style>
</head>
<body>
  <div class="header">
    <a href="index.html" class="back-btn">‚Üê</a>
    <h1>EXAMEN - PILOTO DE SEGURIDAD 05</h1>
    <div class="badge">43 preguntas</div>
    <div class="progress-bar">
      <div class="progress-fill" id="progressBar"></div>
    </div>
  </div>
  
  <div class="container" id="questionsContainer">
    <!-- Questions will be generated here -->
  </div>

  <div class="actions">
    <div class="bar">
      <div>
        <div class="score">Puntuaci√≥n: <span id="score">‚Äî</span></div>
        <div class="score-details" id="scoreDetails"></div>
      </div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <button onclick="calificar()">üìä Calificar</button>
        <button class="secondary" onclick="reiniciar()">üîÑ Reiniciar</button>
        <button class="secondary" onclick="toggleRespuestas(this)">üëÅÔ∏è Ver respuestas</button>
      </div>
    </div>
  </div>

  <button id="scrollTopBtn" class="scroll-top">‚Üë</button>

<script>
// Test data with questions and answers
const testData = {
  "1": {
    "q": "En un P.N clase A3, cuando la anormalidad que produjo el cierre es debida a los elementos o equipos relacionados con la detecci√≥n de las circulaciones ferroviarias, el sistema produce...",
    "a": "C",
    "opts": [
      {"l": "A", "t": "No realiza ninguna acci√≥n."},
      {"l": "B", "t": "El cierre inmediato de las semibarreras y el sistema al cabo de 7 minutos genera la orden de apertura."},
      {"l": "C", "t": "El cierre inmediato de las semibarreras y el sistema al cabo de 10 minutos genera la orden de apertura."},
      {"l": "D", "t": "El cierre inmediato de las semibarreras y las mantiene en esta posici√≥n hasta la llegada del agente a pie de paso"}
    ]},
  "2": {
    "q": "¬øCu√°l es un principio b√°sico de los Bloqueos?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Dos trenes que circulen por la misma v√≠a y en distinto sentido, ir√°n separados una distancia que garantice que no se va a producir un alcance."},
      {"l": "B", "t": "Cuando un tren est√© circulando por una v√≠a, se expedir√° otro en sentido contrario por la misma v√≠a desde la estaci√≥n colateral."},
      {"l": "C", "t": "Las instalaciones garantizar√°n la seguridad necesaria para incompatibilizar las maniobras que se realicen por la banda de una estaci√≥n, con la llegada de un tren por dicha banda."},
      {"l": "D", "t": "Dos trenes que circulen por la misma v√≠a y en el mismo sentido, ir√°n separados una distancia que garantice que no se va a producir un alcance."}
    ]},
  "3": {
    "q": "Un enclavamiento es....",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Un sistema que permite fijar itinerarios seguros para la circulaci√≥n de los trenes en el √°mbito de las estaciones, estableciendo una relaci√≥n de dependencia entre las posiciones de los distintos aparatos de v√≠a del itinerario, las semibarreras de PN (en su caso) y las √≥rdenes que transmiten las se√±ales"},
      {"l": "B", "t": "Sistema o proceso cuyo objetivo es garantizar que los trenes que circulen por la misma v√≠a y en el mismo sentido, lo hagan separados a una distancia que impida su alcance, y que cuando un tren circule por una v√≠a, no circule otro en sentido contrario por la misma v√≠a."},
      {"l": "C", "t": "Infraestructura ferroviaria consistente en una instalaci√≥n de v√≠as y sus aparatos asociados, protegida por se√±ales, y que tiene por objeto coordinar los procesos de la circulaci√≥n."},
      {"l": "D", "t": "Instalaci√≥n de se√±alizaci√≥n situada en plena v√≠a que permite dividir la longitud del cant√≥n de bloqueo"}
    ]},
  "4": {
    "q": "En v√≠a doble, con circulaci√≥n por la izquierda, las se√±ales fijas pueden ubicarse:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Se instalar√°n en el lado de la v√≠a exterior m√°s pr√≥xima, o en la vertical de cada v√≠a."},
      {"l": "B", "t": "En el lado exterior de la v√≠a, el izquierdo, (el opuesto al del entreeje), o en la vertical de cada v√≠a."},
      {"l": "C", "t": "En el lado exterior de la v√≠a, el derecho, (el opuesto al entreeje), o en la vertical de cada v√≠a."},
      {"l": "D", "t": "A ambos lados de la v√≠a, o en la vertical de la misma y si pueden surgir dudas de interpretaci√≥n sobre la v√≠a a la que afecta la se√±al, se instalar√° en dicha se√±al un cartel√≥n con la flecha orientada hacia ella"}
    ]},
  "5": {
    "q": "Marcha a la vista Art.",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Impone al maquinista la obligaci√≥n de avanzar con la prudencia que requiera el caso, regulando la velocidad de acuerdo con la longitud de v√≠a que visualiza por delante del puesto de conducci√≥n, de forma que pueda detener el tren ante cualquier obst√°culo o se√±al de parada. Cuando se prescriba, se indicar√° el motivo y, si se conoce, la naturaleza del obst√°culo, o el tipo de reconocimiento a realizar."},
      {"l": "B", "t": "Impone al maquinista la obligaci√≥n de avanzar con la precauci√≥n que requiera el caso, regulando la velocidad de 30 km/h si la locomotora va tirando del tren, o de 20 km/h si va empuj√°ndolo, de forma que pueda detener el tren ante cualquier obst√°culo visible desde el puesto de conducci√≥n o ante una se√±al de parada. Cuando se prescriba, se indicar√° el motivo y, si se conoce, la naturaleza del obst√°culo, o el tipo de reconocimiento a realizar."},
      {"l": "C", "t": "Impone al maquinista la obligaci√≥n de avanzar con la precauci√≥n que requiera el caso, regulando la velocidad de 20 km/h si la locomotora va tirando del tren, o de 30 km/h si va empuj√°ndolo, de forma que pueda detener el tren ante cualquier obst√°culo visible desde el puesto de conducci√≥n o ante una se√±al de parada. Cuando se prescriba, se indicar√° el motivo y, si se conoce, la naturaleza del obst√°culo, o el tipo de reconocimiento a realizar."},
      {"l": "D", "t": "Impone al maquinista la obligaci√≥n de avanzar con la precauci√≥n que requiera el caso, regulando la velocidad de acuerdo con la longitud de v√≠a que visualiza por delante del puesto de conducci√≥n, de forma que pueda detener el tren ante cualquier obst√°culo o se√±al de parada. Cuando se prescriba, se indicar√° el motivo y, si se conoce, la naturaleza del obst√°culo, o el tipo de reconocimiento a realizar."}
    ]},
  "6": {
    "q": "¬øPara qu√© se elaboran los avisos?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Para regular las condiciones de aplicaci√≥n del RCF en casos espec√≠ficos y en √°mbitos concretos del material remolcado."},
      {"l": "B", "t": "Fijar fechas de entrada en vigor o anulaci√≥n de documentos, en los casos de apertura, cierre o modificaci√≥n de l√≠neas o dependencias, o cuando sea preciso recordar o aclarar normas de circulaci√≥n."},
      {"l": "C", "t": "Dar a conocer las marchas de los trenes, las velocidades m√°ximas de circulaci√≥n, los Cambios Significativos de Velocidad M√°xima, las Limitaciones Temporales de Velocidad M√°xima y el resto de las informaciones relevantes para la circulaci√≥n de los trenes."},
      {"l": "D", "t": "Para regular las condiciones de aplicaci√≥n del RCF en casos espec√≠ficos y en √°mbitos concretos de algunas estaciones."}
    ]},
  "7": {
    "q": "¬øC√≥mo se denomina el tramo de v√≠a en el que, en condiciones normales de circulaci√≥n, no puede haber m√°s de un tren de forma simult√°nea?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Tramo de l√≠nea."},
      {"l": "B", "t": "Trayecto."},
      {"l": "C", "t": "Cant√≥n de bloqueo."},
      {"l": "D", "t": "Bloqueo."}
    ]},
  "8": {
    "q": "¬øQu√© es una combinaci√≥n de dos desv√≠os que permiten unir entre s√≠ dos itinerarios principales no convergentes (Dos v√≠as paralelas)?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Escape."},
      {"l": "B", "t": "Bretelle."},
      {"l": "C", "t": "Haz de v√≠as."},
      {"l": "D", "t": "Traves√≠a de uni√≥n."}
    ]},
  "9": {
    "q": "¬øPor qu√© reglamento se regula el transporte de mercanc√≠as peligrosas que realizan las EF en Espa√±a?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Mediante la autorizaci√≥n de transporte excepcional (ATE)."},
      {"l": "B", "t": "Mediante el Reglamento Internacional sobre el Transporte de Mercanc√≠as Peligrosas por Ferrocarril (RID), sin perjuicio de los reglamentos nacionales y de la UE vigentes."},
      {"l": "C", "t": "A trav√©s del Sistema de Gesti√≥n de Seguridad de las EF (SGS)."},
      {"l": "D", "t": "A trav√©s de las fichas de la Uni√≥n Internacional de Ferrocarriles (UIC)."}
    ]},
  "10": {
    "q": "¬øC√≥mo es la se√±al de fin de limitaci√≥n temporal de velocidad m√°xima?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Cuadrada, fondo amarillo, franja de color negro y sobre √©sta una se√±al de velocidad m√°xima admisible a partir de ese punto."},
      {"l": "B", "t": "Una se√±al de velocidad m√°xima admisible a partir de ese punto."},
      {"l": "C", "t": "Cuadrada, fondo blanco, franja de color negro y sobre √©sta una se√±al de velocidad m√°xima admisible a partir de ese punto."},
      {"l": "D", "t": "Cuadrada, fondo amarillo y franja e inscripciones en color negro."}
    ]},
  "11": {
    "q": "¬øC√≥mo est√° estructurada la NAR 5/17?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "1 glosario, 1 tomo y 2 ap√©ndices."},
      {"l": "B", "t": "1 glosario, 2 tomos y 2 ap√©ndices."},
      {"l": "C", "t": "2 glosarios, 2 tomos y 1 Ap√©ndice."},
      {"l": "D", "t": "2 glosarios, 1 tomo y 2 ap√©ndices."}
    ]},
  "12": {
    "q": "Una derivaci√≥n particular que se√±al de las siguientes tendr√°:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Se√±al de entrada."},
      {"l": "B", "t": "Se√±al de protecci√≥n."},
      {"l": "C", "t": "Se√±al de retroceso."},
      {"l": "D", "t": "Se√±al de maniobras."}
    ]},
  "13": {
    "q": "Los P.N activos (clase A1, A2, A3 y A4):",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Advierten al usuario (conductor o peat√≥n) de la llegada del tren. La protecci√≥n se realiza exclusivamente mediante se√±ales fijas"},
      {"l": "B", "t": "Avisan y/o protegen al usuario (conductor o peat√≥n) de la llegada del tren. Su funcionamiento puede ser autom√°tico."},
      {"l": "C", "t": "No advierten al usuario (conductor o peat√≥n) de la llegada del tren. La protecci√≥n se realiza exclusivamente mediante se√±ales fijas"},
      {"l": "D", "t": "Avisan y/o protegen al usuario (conductor o peat√≥n) de la llegada del tren. Su funcionamiento puede ser autom√°tico o enclavado"}
    ]},
  "14": {
    "q": "En caso de interceptaci√≥n para trenes o cortes de material detenidos en plena v√≠a, ¬øc√≥mo se actuar√°?:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Se aplicar√° la protecci√≥n normal en las v√≠as afectadas."},
      {"l": "B", "t": "En l√≠neas con circuitos de v√≠a, se aplicar√° la protecci√≥n de emergencia, por detr√°s, cuando se encuentren descarrilados totalmente."},
      {"l": "C", "t": "Se aplicar√° la protecci√≥n de emergencia en la v√≠a o v√≠as contiguas y otras afectadas."},
      {"l": "D", "t": "En l√≠neas con circuitos de v√≠a, se aplicar√° la protecci√≥n de emergencia, por delante y por detr√°s, cuando se encuentren descarrilados totalmente."}
    ]},
  "15": {
    "q": "En la protecci√≥n de emergencia de un punto interceptado para avisar al maquinista de cualquier circulaci√≥n que se dirija hacia dicho punto, para que se detenga antes de llegar al mismo, que se har√° primero:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Avisar al maquinista afectado mediante la radiotelefon√≠a."},
      {"l": "B", "t": "Haciendo la se√±al de alarma, sobre todo en trayectos con v√≠a doble o m√∫ltiple."},
      {"l": "C", "t": "Presentando desde la v√≠a las se√±ales port√°tiles de parada al tren o trenes que se aproximen, a ser posible a la distancia de 1.500 m."},
      {"l": "D", "t": "La forma de actuar depender√° de las circunstancias, aunque siempre ser√° fundamental la rapidez con que se act√∫e para avisar al tren que se encuentre m√°s pr√≥ximo al lugar de peligro."}
    ]},
  "16": {
    "q": "Como proteger√°n los trabajos en Intervalo de liberaci√≥n por tiempo el Encargado de trabajos o Piloto de seguridad habilitado para concertar trabajos:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "En trayectos dotados de circuitos de v√≠a y siempre que los trabajos sean compatibles con el uso de √∫tiles de cortocircuito, colocar√° la barra o √∫til de cortocircuito. En trayectos carentes de circuitos de v√≠a o cuando los trabajos no resulten compatibles con el uso de √∫tiles de cortocircuito, instalar√° se√±ales port√°tiles de parada a una distancia m√≠nima de 1500 metros del tajo, por la cabecera desde donde se reciban los trenes en sentido normal, o por ambas cabeceras del tajo en caso de v√≠as banalizadas. Asimismo, previamente al inicio de los trabajos se instalar√°n cartelones de 'Silbar Obreros' en la v√≠a o v√≠as contiguas con circulaci√≥n compatible con los trabajos."},
      {"l": "B", "t": "En trayectos no dotados de circuitos de v√≠a y siempre que los trabajos sean compatibles con el uso de √∫tiles de cortocircuito, colocar√° la barra o √∫til de cortocircuito. En trayectos carentes de circuitos de v√≠a o cuando los trabajos no resulten compatibles con el uso de √∫tiles de cortocircuito, instalara cartelones port√°tiles de parada a una distancia m√≠nima de 500 metros del tajo, por la cabecera desde donde se reciban los trenes en sentido normal, o por ambas cabeceras del tajo en caso de v√≠as banalizadas. Asimismo, previamente al inicio de los trabajos se instalar√°n cartelones de 'Silbar Obreros' en la v√≠a o v√≠as contiguas con circulaci√≥n compatible con los trabajos."},
      {"l": "C", "t": "En v√≠as de estaci√≥n dotados de circuitos de v√≠a y siempre que los trabajos sean compatibles con el uso de √∫tiles de cortocircuito, colocar√° la barra o util de cortocircuito. En v√≠as carentes de circuitos de via o cuando los trabajos no resulten compatibles con el uso de √∫tiles de cortocircuito, instalar√° cartelones de parada en el eje de la v√≠a incluso cuando sea posible orientar las agujas en la posici√≥n adecuada."},
      {"l": "D", "t": "En trayectos dotados de circuitos de v√≠a y siempre que los trabajos sean compatibles con el uso de √∫tiles de cortocircuito, colocar√° la barra o √∫til de cortocircuito. En trayectos carentes de circuitos de v√≠a o cuando los trabajos no resulten compatibles con el uso de √∫tiles de cortocircuito, instalar√° se√±ales port√°tiles de parada a una distancia m√≠nima de 500 metros del tajo, por la cabecera desde donde se reciban los trenes en sentido normal, o por ambas cabeceras del tajo en caso de v√≠as banalizadas. Asimismo, previamente al inicio de los trabajos se instalar√°n cartelones de 'Silbar Obreros' en la v√≠a o v√≠as contiguas con circulaci√≥n compatible con los trabajos."}
    ]},
  "17": {
    "q": "Partes del carril:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Cabeza, junta y pat√≠n."},
      {"l": "B", "t": "Cabeza, alma y base."},
      {"l": "C", "t": "Cabeza, cuerpo y pat√≠n."},
      {"l": "D", "t": "Cabeza, alma y pat√≠n."}
    ]},
  "18": {
    "q": "¬øCu√°l es la funci√≥n de la chapa 'cubrebalizas'",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Impedir la transmisi√≥n baliza-captador, situado en el tren."},
      {"l": "B", "t": "Impedir la transmisi√≥n baliza captador, situado en el CTC."},
      {"l": "C", "t": "Impedir la transmisi√≥n baliza captador, situado en el P.M"},
      {"l": "D", "t": "Permitir la transmisi√≥n baliza captador, situado en el CTC."}
    ]},
  "19": {
    "q": "¬øEl sistema de intervalo de liberaci√≥n por tiempo es incompatible? 3.3.2.2.",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Con BAB, BTV."},
      {"l": "B", "t": "Con BAD."},
      {"l": "C", "t": "BTV."},
      {"l": "D", "t": "BSL."}
    ]},
  "20": {
    "q": "El personal ferroviario est√° obligado a:1/18",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Abstenerse de abandonar o ausentarse del servicio sin autorizaci√≥n y sin adoptar las medidas necesarias para garantizar la seguridad. Si por fuerza mayor o para evitar un peligro tuviese que ausentarse de forma urgente, sin obtener autorizaci√≥n, no podr√° abandonar el servicio."},
      {"l": "B", "t": "Abstenerse de abandonar o ausentarse del servicio con autorizaci√≥n. Si por fuerza mayor o para evitar un peligro tuviese que ausentarse de forma urgente, sin obtener autorizaci√≥n, adoptar√° las prevenciones oportunas, sin perjuicio de informar y retomar el servicio en cuanto sea posible."},
      {"l": "C", "t": "Poder abandonar o ausentarse del servicio sin autorizaci√≥n si se adoptan las medidas necesarias para garantizar la seguridad y las prevenciones oportunas, sin perjuicio de informar y retomar el servicio en cuanto sea posible."},
      {"l": "D", "t": "Abstenerse de abandonar o ausentarse del servicio sin autorizaci√≥n y sin adoptar las medidas necesarias para garantizar la seguridad. Si por fuerza mayor o para evitar un peligro tuviese que ausentarse de forma urgente, sin obtener autorizaci√≥n, adoptar√° las prevenciones oportunas, sin perjuicio de informar y retomar el servicio en cuanto sea posible."}
    ]},
  "21": {
    "q": "Trabajo no compatible con la circulaci√≥n de trenes:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Con car√°cter general, los trabajos que afecten al funcionamiento normal de la v√≠a, la electrificaci√≥n y las instalaciones de seguridad, as√≠ como los trabajos de cualquier naturaleza con maquinaria en la 'Zona de peligro para los trabajos', 'Zona de riesgo para los trabajos' o 'Zona de seguridad para los trabajos', a√∫n de forma puntual, entrar√≠an dentro de este concepto."},
      {"l": "B", "t": "Con car√°cter general, los trabajos que afecten al funcionamiento normal de la v√≠a, la electrificaci√≥n y las instalaciones de seguridad, as√≠ como los trabajos de cualquier naturaleza con maquinaria en la 'Zona de riesgo para los trabajos' o 'Zona de seguridad para los trabajos', a√∫n de forma puntual, entrar√≠an dentro de este concepto."},
      {"l": "C", "t": "Con car√°cter general, los trabajos que afecten al funcionamiento normal de la v√≠a, la electrificaci√≥n y las instalaciones de seguridad, as√≠ como los trabajos de cualquier naturaleza con maquinaria en la 'Zona de peligro para los trabajos' o 'Zona de seguridad para los trabajos', a√∫n de forma puntual, entrar√≠an dentro de este concepto."},
      {"l": "D", "t": "Con car√°cter general, los trabajos que afecten al funcionamiento normal de la via, la electrificaci√≥n y las instalaciones de seguridad, as√≠ como los trabajos de cualquier naturaleza con maquinaria en la 'Zona de peligro para los trabajos' o 'Zona de riesgo para los trabajos', a√∫n de forma puntual, entrar√≠an dentro de este concepto."}
    ]},
  "22": {
    "q": "Definici√≥n de Plataforma",
    "a": "D",
    "opts": [
      {"l": "A", "t": "La Plataforma es la parte superior de la infraestructura ferroviaria en la que se apoya la superestructura de v√≠a."},
      {"l": "B", "t": "La Plataforma es la parte inferior de la infraestructura ferroviaria en la que se apoya la superestructura de v√≠a."},
      {"l": "C", "t": "Es el conjunto de traviesas y carriles"},
      {"l": "D", "t": "Ninguna es correcta"}
    ]},
  "23": {
    "q": "En el supuesto de baja temporal de las instalaciones del PN por reparaci√≥n o mantenimiento de estas, se le dotar√° de:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Personal a pie de paso o se cerrar√° el tr√°nsito."},
      {"l": "B", "t": "Se cerrar√° al tr√°nsito."},
      {"l": "C", "t": "Se aplicar√° una protecci√≥n de clase P."},
      {"l": "D", "t": "Personal a pie de paso"}
    ]},
  "24": {
    "q": "¬øC√≥mo se denomina y qu√© ordena la siguiente se√±al?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Se denomina parada selectiva, y ordena parar ante ella sin rebasarla cuando se circule con trenes sin ERTMS."},
      {"l": "B", "t": "Se denomina parada y si la se√±al mantiene esta misma indicaci√≥n transcurridos tres minutos desde la parada, el Maquinista, si nada se opone, avanzar√° con marcha a la vista, sin exceder la velocidad de 40 km/h, hasta llegar a la siguiente se√±al fija fundamental (no consider√°ndose a estos efectos las SPN),y se atendr√° a lo que esta ordena cualquiera que sea su indicaci√≥n. Tendr√° muy en cuenta que antes de llegar a esta √öltima se√±al se puede encontrar un tren, en cuyo caso se detendr√° a unos 50 metros de esta Si a continuaci√≥n de √©sta, existieran agujas, no se exceder√° la velocidad de 30 km/h al paso por ellas."},
      {"l": "C", "t": "Se denomina parada selectiva y despu√©s de la parada, y si nada se opone, el Maquinista avanzar√° con marcha a la vista, sin exceder la velocidad de 40 km/h, hasta llegar a la se√±al siguiente."},
      {"l": "D", "t": "Se denomina parada y si la se√±al mantiene esta misma indicaci√≥n transcurridos tres minutos desde la parada, el Maquinista, si nada se opone, avanzar√° con marcha a la vista, sin exceder la velocidad de 40 km/h, hasta llegar a la siguiente se√±al fija fundamental (no consider√°ndose a estos efectos las SPN),y se atendr√° a lo que esta ordena cualquiera que sea su indicaci√≥n. Tendr√° muy en cuenta que antes de llegar a esta √∫ltima se√±al se puede encontrar un tren, en cuyo caso se detendr√° a unos 15 metros de esta Si a continuaci√≥n de √©sta, existieran agujas, no se exceder√° la velocidad de 30 km/h al paso por ellas."}
    ]},
  "25": {
    "q": "En trabajos en estaciones en v√≠as carentes de circuitos de v√≠a o no compatibles con el uso de √∫tiles de cortocircuito el Encargado o Piloto de seguridad habilitado para concertar trabajos una vez autorizado para realizarlos, y antes de su inicio los proteger√°:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Colocar√° la barra o √∫til de cortocircuito. A continuaci√≥n, verificar√° la ocupaci√≥n artificial del circuito de v√≠a mediante la confirmaci√≥n del Responsable de Circulaci√≥n o, cuando no sea posible, por observaci√≥n directa de que la se√±al que protege la v√≠a ocupada est√° en indicaci√≥n de parada."},
      {"l": "B", "t": "Instalar√° se√±ales port√°tiles de parada en el eje de la v√≠a y por ambos lados, incluso cuando sea posible orientar las agujas en la posici√≥n adecuada."},
      {"l": "C", "t": "Instalar√° se√±ales port√°tiles de parada en el eje de la v√≠a a 500 m y por ambos lados, incluso cuando sea posible orientar las agujas en la posici√≥n adecuada,"},
      {"l": "D", "t": "Instalara se√±ales port√°tiles de parada en el eje de la v√≠a y por ambos lados, cuando no sea posible orientar las agujas en la posici√≥n adecuada."}
    ]},
  "26": {
    "q": "¬øA que distancia se colocar√°n los cartelones de Silbar obreros, cuando su instalaci√≥n est√© motivada por la presencia de personal trabajando en la v√≠a?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "A la distancia t√©cnica de operatividad, 5,5 veces la velocidad m√°xima permitida del tren a la altura del punto afectado, en km/h."},
      {"l": "B", "t": "A la distancia de visibilidad t√©cnica, 5,5 veces la velocidad m√°xima permitida del tren a la altura del punto afectado, en km/h."},
      {"l": "C", "t": "A la distancia t√©cnica de operatividad, 5,5 veces la velocidad m√°xima permitida del tren a la altura del punto afectado, en km/h."},
      {"l": "D", "t": "A la distancia de visibilidad t√©cnica, entre 1,0 y 1,4 veces la velocidad m√°xima permitida del tren a la altura del punto afectado, en km/h."}
    ]},
  "27": {
    "q": "Para que son emitidas las consignas, selecciona la respuesta correcta.",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Describir las caracter√≠sticas, el funcionamiento y la operaci√≥n de toda clase de instalaciones de seguridad"},
      {"l": "B", "t": "Regular aspectos espec√≠ficos sobre la marcha de los trenes"},
      {"l": "C", "t": "Regular aspectos espec√≠ficos sobre gesti√≥n de las estaciones."},
      {"l": "D", "t": "Describir las caracteristicas, el funcionamiento y la operaci√≥n de toda clase de bloqueos."}
    ]},
  "28": {
    "q": "La interrupci√≥n de la circulaci√≥n se establece por:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Intervalo de horario, intervalo programado y por anormalidad."},
      {"l": "B", "t": "Intervalo de liberaci√≥n por tiempo, intervalo programado y entrega de v√≠a bloqueado."},
      {"l": "C", "t": "Intervalo de liberaci√≥n por tiempo, entrega de via bloqueado y por anormalidad."},
      {"l": "D", "t": "Intervalo de liberaci√≥n por tiempo, intervalo programado y anormalidad."}
    ]},
  "29": {
    "q": "En l√≠neas de alta velocidad con BCA cuando tenga que circular un tren sin el equipo embarcado del ATP, que bloqueo se aplicara:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "BAB, BT."},
      {"l": "B", "t": "BT."},
      {"l": "C", "t": "BSL."},
      {"l": "D", "t": "BSL o BT."}
    ]},
  "30": {
    "q": "En los trabajos no programados (por aver√≠as, accidentes, etc.), quien informar√° al Responsable de Circulaci√≥n del sistema de trabajos a emplear, dentro de los previstos en el RCF, en funci√≥n de su complejidad, importancia u otras circunstancias:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "El Encargado de trabajos o Piloto de seguridad habilitado para concertar trabajos."},
      {"l": "B", "t": "El Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del Puesto de Mando."},
      {"l": "C", "t": "El AI lo determinara en su SGS."},
      {"l": "D", "t": "Las A√©reas T√©cnicas de las gerencias del AI."}
    ]},
  "31": {
    "q": "El maquinista, durante la aplicaci√≥n de EVB, ¬øc√≥mo proceder√°?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Considerar√° inexistentes las se√±ales intermedias en l√≠neas de BA y las de los PCA en l√≠neas de BSL."},
      {"l": "B", "t": "Considerar√° inexistentes todas las se√±ales (excepto las de entrada y salida) en l√≠neas de BA y las de los PCA en l√≠neas de BSL."},
      {"l": "C", "t": "Considerar√° inexistentes las se√±ales avanzadas, las intermedias en l√≠neas de BA y las de los PCA en l√≠neas de BSL."},
      {"l": "D", "t": "Considerar√° inexistentes las se√±ales avanzadas dotadas de la letra 'P' y las intermedias en l√≠neas de BA y las de los PCA en l√≠neas de BSL."}
    ]},
  "32": {
    "q": "En EVB, se podr√°n realizar diferentes trabajos en una misma v√≠a, estando la concertaci√≥n y coordinaci√≥n a cargo:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Habr√° diferentes Encargados de trabajos por cada uno de ellos."},
      {"l": "B", "t": "Un mismo Encargado de trabajos al que se le concedi√≥ la EVB, respetando la hora de comienzo y finalizaci√≥n concedidos."},
      {"l": "C", "t": "Para cada trayecto y v√≠a entre dos estaciones abiertas afectada por una EVB, habr√° un Encargado de trabajos o pruebas."},
      {"l": "D", "t": "En v√≠a doble o m√∫ltiple se podr√° tener un solo Encargado de trabajos, cuando sean coincidentes los puntos de inicio y finalizaci√≥n de la EVB en ambas v√≠as."}
    ]},
  "33": {
    "q": "¬øCu√°l es el objeto del Reglamento de Circulaci√≥n Ferroviaria?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "El objeto de este Reglamento es establecer reglas operativas generales para que la circulaci√≥n de los trenes se realice de forma segura, eficiente y puntual"},
      {"l": "B", "t": "El objeto de este Reglamento es establecer reglas operativas generales para que la circulaci√≥n de las maniobras se realice de forma segura, eficiente y puntual"},
      {"l": "C", "t": "El objeto de este Reglamento es establecer reglas operativas generales para que la circulaci√≥n de los trenes y de las maniobras se realice de forma segura y eficiente"},
      {"l": "D", "t": "El objeto de este Reglamento es establecer reglas operativas generales para que la circulaci√≥n de los trenes y de las maniobras se realice de forma segura, eficiente y puntual."}
    ]},
  "34": {
    "q": "En cu√°l de estos paneles se indica que reacciona peligrosamente con el agua?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "335"},
      {"l": "B", "t": "43"},
      {"l": "C", "t": "453"},
      {"l": "D", "t": "X 52"}
    ]},
  "35": {
    "q": "Las actividades de Regulaci√≥n Espec√≠fica son:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Aquellas actividades sujetas a una Instrucci√≥n Especifica de Trabajo, a realizar exclusivamente con herramientas manuales, que invadan o puedan invadir (aun siendo de manera puntual) las zona de peligro o la de riesgo, y que, por su naturaleza, no afecten al funcionamiento normal de la v√≠a, la electrificaci√≥n y las instalaciones de seguridad, puedan desarrollarse de forma segura sin circulaciones (sin simultaneidad con circulaciones ferroviarias) por cumplir los requisitos minimos."},
      {"l": "B", "t": "Con car√°cter general, las actividades que afecten al funcionamiento normal de la v√≠a, la electrificaci√≥n y las instalaciones de seguridad, as√≠ como los trabajos de cualquier naturaleza con maquinaria en la 'Zona de peligro para los trabajos' o 'Zona de riesgo para los trabajos', a√∫n de forma puntual, entrar√≠an dentro de este concepto."},
      {"l": "C", "t": "Aquella actividad que por su naturaleza, zona afectada, tipo de herramientas o medios a emplear y condiciones de ejecuci√≥n, requiere que la v√≠a donde se vaya a desarrollar est√© libre de trenes para garantizar tanto la protecci√≥n de los trabajos como la circulaci√≥n segura de los trenes y maniobras."},
      {"l": "D", "t": "Toda actividad de mantenimiento preventivo o correctivo en la infraestructura, superestructura e instalaciones de seguridad, as√≠ como aquellas obras o intervenciones de distinta naturaleza, que se ejecuten dentro de la zona de dominio p√∫blico o, en su caso, cerramiento de la l√≠nea, con afecci√≥n a las denominadas 'Zona de peligro para los trabajos', 'Zona de riesgo para los trabajos' y 'Zona de seguridad para los trabajos'."}
    ]},
  "36": {
    "q": "En ILT, cuando en un mismo trayecto se realicen trabajos de naturaleza diferente o situados en puntos alejados, todos ellos se considerar√°n independientes y dispondr√°n de un: Art.",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Habr√° diferentes Encargados de trabajos por cada uno de ellos."},
      {"l": "B", "t": "Un mismo Encargado de trabajos al que se le concedi√≥ la v√≠a, respetando la hora de comienzo y finalizaci√≥n concedidos."},
      {"l": "C", "t": "De un Encargado de Trabajos o Piloto de seguridad habilitado para concertar trabajos en cada uno."},
      {"l": "D", "t": "En v√≠a doble o m√∫ltiple se podr√° tener un solo Encargado de trabajos, cuando sean coincidentes los puntos de inicio y finalizaci√≥n en ambas v√≠as."}
    ]},
  "37": {
    "q": "Indique el nombre de la clase a la que pertenece esta se√±al:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Materias t√≥xicas."},
      {"l": "B", "t": "Materias infecciosas."},
      {"l": "C", "t": "Materias t√≥xico-infecciosas de clase III."},
      {"l": "D", "t": "Per√≥xidos org√°nicos"}
    ]},
  "38": {
    "q": "Calce descarrilador:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Aparato de v√≠a m√≥vil que se coloca con sujeci√≥n fija sobre la cabeza y alma del carril mediante pesta√±as candadas, en las v√≠as para evitar que los trenes o veh√≠culos puedan llegar a acceder de modo imprevisto a v√≠as secundarias o generales de circulaci√≥n."},
      {"l": "B", "t": "Cu√±a de tope o trinquete de hierro colocado debajo de una rueda junto al carril para evitar que el veh√≠culo se deslice o ruede."},
      {"l": "C", "t": "Aparato o trinquete de madera colocado debajo de una rueda junto al carril para evitar que el veh√≠culo se deslice o ruede."},
      {"l": "D", "t": "Dispositivo de seguridad incorporado al carril el cual, cuando est√° izado, causa el descarrilamiento del veh√≠culo que ha circulado sobre el mismo."}
    ]},
  "39": {
    "q": "¬øA que se denominan Marcos y cu√°l es su tama√±o?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Obras de f√°brica de secci√≥n circular y prefabricados de hormig√≥n, su tama√±o var√≠a entre 2,50 metros hasta un m√°ximo de 10 metros."},
      {"l": "B", "t": "Obras de f√°brica de secci√≥n rectangular y prefabricados de hormig√≥n, su tama√±o var√≠a entre 2,50 metros hasta un m√°ximo de 6 metros."},
      {"l": "C", "t": "Obras de tierra de secci√≥n rectangular y prefabricados de hormig√≥n, su tama√±o var√≠a entre 2,50 metros hasta un m√°ximo de 6 metros."},
      {"l": "D", "t": "Obras de f√°brica de secci√≥n rectangular y prefabricados de hormig√≥n, su tama√±o var√≠a entre 2,50 metros hasta un m√°ximo de 10 metros."}
    ]},
  "40": {
    "q": "¬øC√≥mo se denominan y qu√© ordenan estas se√±ales?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Paso a nivel protegido y ordena circular normalmente por el PN o grupo de PN, e informar inmediatamente del estado de la se√±al, por radiotelefon√≠a, al Responsable de Circulaci√≥n del CTC, o de la Banda de Regulaci√≥n del PM o, en ausencia de radiotelefon√≠a, al Responsable de Circulaci√≥n de la primera estaci√≥n abierta."},
      {"l": "B", "t": "Paso a nivel protegido y ordena circular normalmente por el PN o grupo de PN, e informar inmediatamente del estado de la se√±al, por radiotelefon√≠a, al Responsable de Circulaci√≥n del CTC, o en ausencia de radiotelefon√≠a, al Responsable de Circulaci√≥n de la primera estaci√≥n abierta donde tenga parada"},
      {"l": "C", "t": "Paso a nivel protegido y ordena ponerse en condiciones de parar ante el PN o ante cada PN del grupo, sin rebasar ninguno hasta haberse asegurado de que no est√° transitado, adoptando, en su caso, el Maquinista las medidas complementarias de seguridad que estime necesarias."},
      {"l": "D", "t": "Paso a nivel sin protecci√≥n y ordena circular normalmente por el PN o grupo de PN, e informar inmediatamente del estado de la se√±al, por radiotelefon√≠a, al Responsable de Circulaci√≥n del CTC, o de la Banda de Regulaci√≥n del PM o, en ausencia de radiotelefon√≠a, al Responsable de Circulaci√≥n de la primera estaci√≥n abierta."}
    ]},
  "41": {
    "q": "Elementos constitutivos de algunos vagones plataforma situados en sus extremos empleados para la sujeci√≥n del cargamento en sentido longitudinal.",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Testeros."},
      {"l": "B", "t": "Teleros"},
      {"l": "C", "t": "Tabiques de separaci√≥n"},
      {"l": "D", "t": "Calces"}
    ]},
  "42": {
    "q": "¬øA que llamamos vagoneta?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Veh√≠culo autopropulsado destinado al servicio de la red, las del servicio de infraestructura y v√≠a se utilizan generalmente para el transporte de personal."},
      {"l": "B", "t": "Son para el transporte de personal y tienen tambi√©n un castillete para realizar trabajos en la LAC."},
      {"l": "C", "t": "Veh√≠culo autopropulsado destinado al servicio de la red, las del servicio de infraestructura y v√≠a se utilizan generalmente para el transporte de personal, aunque algunas vienen con una peque√±a gr√∫a. Las del servicio de electrificaci√≥n son para el transporte de personal y tienen tambi√©n un castillete para realizar trabajos en la LAC."},
      {"l": "D", "t": "Adem√°s de nivelar y alinear, batea, midiendo los defectos del trazado de la v√≠a y corrigi√©ndolos, coloc√°ndola en su posici√≥n exacta en planta y alzado. Existen dos tipos una especial para desv√≠os y otra para trayectos b√°sicamente"}
    ]},
  "43": {
    "q": "Para un corte urgente de tensi√≥n en catenaria que datos hay que facilitar.",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Trayecto y v√≠a para la que solicita el corte. Se identificar√° de forma clara la v√≠a o v√≠as afectadas, empleando las expresiones I, II, etc."},
      {"l": "B", "t": "Trayecto o estaci√≥n y v√≠a para la que solicita el corte. Se identificar√° de forma clara la v√≠a o v√≠as afectadas, empleando las expresiones I, II, etc."},
      {"l": "C", "t": "Trayecto o estaci√≥n y v√≠a para la que solicita el corte. Se identificar√° de forma clara la v√≠a o vias afectadas, empleando las expresiones I, II, etc. y el motivo."},
      {"l": "D", "t": "El corte urgente de tensi√≥n en catenaria no se puede solicitar."}
    ]}
}

let respuestasVisibles = false;
let totalPreguntas = Object.keys(testData).length;

// Generate all questions on page load
function generarTest() {
  const container = document.getElementById('questionsContainer');
  
  Object.keys(testData).forEach(qid => {
    const q = testData[qid];
    const card = document.createElement('div');
    card.className = 'card question';
    card.dataset.qid = qid;
    
    let opcionesHTML = '';
    q.opts.forEach(opt => {
      opcionesHTML += `
        <label class="option">
          <input type="radio" name="q${qid}" value="${opt.l}" onchange="updateProgress()" />
          <div><b>${opt.l})</b> ${opt.t}</div>
        </label>
      `;
    });

    card.innerHTML = `
      <span class="q-number">Pregunta ${qid} de ${totalPreguntas}</span>
      <div class="q-title">${q.q}</div>
      <div class="options">${opcionesHTML}</div>
      <div class="answer-key">‚úì Respuesta correcta: <b>${q.a}</b></div>
      <div class="feedback"></div>
    `;
    
    container.appendChild(card);
  });
}

// Update progress bar
function updateProgress() {
  const respondidas = document.querySelectorAll('input[type=radio]:checked').length;
  const porcentaje = (respondidas / totalPreguntas) * 100;
  document.getElementById('progressBar').style.width = porcentaje + '%';
}

// Grade the test
function calificar() {
  let correctas = 0;
  let incorrectas = 0;
  let sinResponder = 0;
  
  document.querySelectorAll('.question').forEach(card => {
    const qid = card.dataset.qid;
    const correcta = testData[qid].a;
    const seleccionada = card.querySelector('input[type=radio]:checked');
    
    card.querySelectorAll('.option').forEach(o => o.classList.remove('correct','incorrect'));
    
    if (seleccionada) {
      const letra = seleccionada.value;
      if (letra === correcta) {
        correctas++;
        seleccionada.closest('.option').classList.add('correct');
        card.querySelector('.feedback').textContent = '‚úî ¬°Correcto!';
        card.querySelector('.feedback').style.color = 'var(--ok)';
      } else {
        incorrectas++;
        seleccionada.closest('.option').classList.add('incorrect');
        card.querySelector('.feedback').innerHTML = `‚úñ Incorrecto ¬∑ La correcta es: <b>${correcta}</b>`;
        card.querySelector('.feedback').style.color = 'var(--bad)';
        const corr = card.querySelector(`input[value="${correcta}"]`);
        if (corr) corr.closest('.option').classList.add('correct');
      }
    } else {
      sinResponder++;
      card.querySelector('.feedback').textContent = '‚ö† Sin responder';
      card.querySelector('.feedback').style.color = 'var(--warning)';
    }
  });
  
  const porcentaje = Math.round((correctas / totalPreguntas) * 100);
  const aprobado = porcentaje >= 50;
  
  document.getElementById('score').textContent = `${correctas} / ${totalPreguntas} (${porcentaje}%)`;
  document.getElementById('score').style.color = aprobado ? 'var(--ok)' : 'var(--bad)';
  
  document.getElementById('scoreDetails').innerHTML = `
    ‚úî ${correctas} correctas ¬∑ ‚úñ ${incorrectas} incorrectas ¬∑ ‚ö† ${sinResponder} sin responder
  `;
  
  // Scroll to top to see results
  // window.scrollTo({top: 0, behavior: 'smooth'});
}

// Reset the test
function reiniciar() {
  document.querySelectorAll('input[type=radio]').forEach(r => r.checked = false);
  document.querySelectorAll('.option').forEach(o => o.classList.remove('correct','incorrect'));
  document.querySelectorAll('.feedback').forEach(f => {f.textContent=''; f.removeAttribute('style')});
  document.getElementById('score').textContent = '‚Äî';
  document.getElementById('score').removeAttribute('style');
  document.getElementById('scoreDetails').textContent = '';
  document.getElementById('progressBar').style.width = '0%';
  window.scrollTo({top: 0, behavior: 'smooth'});
}

// Toggle answer visibility
function toggleRespuestas(btn) {
  respuestasVisibles = !respuestasVisibles;
  document.body.classList.toggle('show-answers', respuestasVisibles);
  btn.textContent = respuestasVisibles ? 'üôà Ocultar respuestas' : 'üëÅÔ∏è Ver respuestas';
  
  if (respuestasVisibles) {
    document.querySelectorAll('.question').forEach(card => {
      const qid = card.dataset.qid;
      const correcta = testData[qid].a;
      card.querySelectorAll('.option').forEach(o => o.classList.remove('correct'));
      const corr = card.querySelector(`input[value="${correcta}"]`);
      if (corr) corr.closest('.option').classList.add('correct');
    });
  } else {
    document.querySelectorAll('.option').forEach(o => o.classList.remove('correct'));
  }
}

// Initialize test on page load
window.addEventListener('load', () => {
  generarTest();
});

  // Scroll to top button functionality
const scrollTopBtn = document.getElementById('scrollTopBtn');

// Show/hide button based on scroll position
window.addEventListener('scroll', () => {
  if (window.pageYOffset > 300) {
    scrollTopBtn.classList.add('visible');
  } else {
    scrollTopBtn.classList.remove('visible');
  }
});

// Smooth scroll to top on click
scrollTopBtn.addEventListener('click', () => {
  window.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
});
</script>
</body>
</html>
