<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RCF 4 - COMPLETO</title>
<style>
:root{--bg:#0b132b;--card:#1c2541;--accent:#5bc0be;--ok:#21c17a;--bad:#ff5d73;--text:#f5f7ff;--warning:#ffc107}
*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,system-ui,-apple-system,Roboto,Ubuntu,'Helvetica Neue',Arial,sans-serif;background:linear-gradient(135deg,var(--bg),#0f1a3a);color:var(--text);min-height:100vh;font-size:14px}
.header{padding:12px 10px;text-align:center;border-bottom:1px solid rgba(255,255,255,.08);position:sticky;top:0;background:rgba(11,19,43,.98);backdrop-filter:blur(10px);z-index:100;position:relative}
.header h1{margin:0 0 6px 0;font-size:1.2rem;font-weight:700}
.back-btn{position:absolute;left:10px;top:50%;transform:translateY(-50%);width:36px;height:36px;padding:0;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.15);border-radius:50%;color:var(--text);text-decoration:none;font-size:18px;transition:all .2s;line-height:1;display:flex;align-items:center;justify-content:center}
.back-btn:active{background:rgba(255,255,255,.15);transform:translateY(-50%) scale(.95)}
.badge{display:inline-block;padding:3px 10px;border-radius:999px;background:rgba(255,255,255,.08);font-size:11px;margin-top:4px}
.tabs{display:flex;gap:6px;flex-wrap:wrap;margin:8px 0;justify-content:center}
.tab{border:1px solid rgba(255,255,255,.15);border-radius:50%;width:32px;height:32px;padding:0;background:rgba(255,255,255,.08);cursor:pointer;color:var(--text);transition:all .2s;font-size:13px;font-weight:700;display:flex;align-items:center;justify-content:center}
.tab.active{background:var(--accent);border-color:var(--accent);color:#001018}
.tab:active{background:rgba(91,192,190,.2);border-color:rgba(91,192,190,.3)}
.container{max-width:1000px;margin:0 auto;padding:10px 8px 100px}
.progress-bar{background:rgba(255,255,255,.1);height:3px;border-radius:999px;margin:8px 0;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--accent),#3a9d9a);width:0%;transition:width .3s ease}
.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px;margin:8px 0;box-shadow:0 4px 12px rgba(0,0,0,.2)}
.q-title{font-weight:600;margin-bottom:10px;line-height:1.4;font-size:14px}
.q-number{color:var(--accent);font-size:11px;font-weight:700;margin-bottom:6px;display:block}
.options{display:grid;grid-template-columns:1fr;gap:6px}
.option{background:#121a34;border:2px solid rgba(255,255,255,.08);padding:8px;border-radius:8px;display:flex;align-items:flex-start;gap:8px;cursor:pointer;transition:all .2s;font-size:13px;line-height:1.3}
.option:active{background:#1a2341;border-color:rgba(91,192,190,.3)}
.option input{margin-top:2px;cursor:pointer;flex-shrink:0}
.option div{flex:1}
.answer-key{display:none;margin-top:8px;padding:8px;background:rgba(91,192,190,.1);border-radius:6px;font-size:12px}
.answer-key b{color:var(--accent)}
.show-answers .answer-key{display:block}
.feedback{margin-top:6px;font-size:12px;font-weight:600;padding:6px;border-radius:4px}
.correct{border-color:rgba(33,193,122,.6)!important;background:rgba(33,193,122,.05)!important}
.incorrect{border-color:rgba(255,93,115,.75)!important;background:rgba(255,93,115,.05)!important}
.actions{position:fixed;bottom:0;left:0;right:0;background:linear-gradient(180deg,rgba(15,26,58,0),rgba(15,26,58,.99));padding:10px 8px;padding-bottom:calc(10px + env(safe-area-inset-bottom));backdrop-filter:blur(10px);border-top:1px solid rgba(255,255,255,.08);z-index:99}
.actions .bar{max-width:1000px;margin:0 auto;display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
button{background:var(--accent);border:none;color:#001018;font-weight:700;padding:10px 14px;border-radius:8px;cursor:pointer;transition:all .2s;font-size:13px;touch-action:manipulation}
button:active{background:var(--accent);opacity:.9;transform:scale(.98)}
button.secondary{background:transparent;border:1px solid rgba(255,255,255,.35);color:var(--text)}
button.secondary:active{background:rgba(255,255,255,.05)}
.score{font-weight:700;font-size:1rem}
.score-details{font-size:11px;color:var(--text);opacity:.8;margin-top:2px}
.footer{opacity:.8;font-size:11px;text-align:center;padding:15px;color:rgba(255,255,255,.5)}
@media (min-width: 720px){
  .options{grid-template-columns:1fr 1fr}
  body{font-size:15px}
  .card{padding:20px;margin:16px 0;border-radius:16px}
  .q-title{font-size:15px;margin-bottom:12px}
  .option{padding:12px;gap:10px;font-size:14px}
  .header{padding:20px 16px}
  .header h1{font-size:1.5rem;margin-bottom:8px}
  .container{padding:20px 16px 120px}
  button{padding:12px 18px;font-size:14px}
  .tab{width:40px;height:40px;font-size:15px}
}
@media (max-width: 640px){
  .actions .bar{flex-direction:column;gap:6px}
  .score{text-align:center;width:100%;font-size:0.95rem}
  .actions{padding:8px 6px;padding-bottom:calc(8px + env(safe-area-inset-bottom))}
  button{width:100%;padding:11px 12px}
}
.scroll-top{position:fixed;bottom:20px;right:20px;width:40px;height:40px;background:var(--accent);color:#fff;border:none;border-radius:50%;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.2);display:flex;align-items:center;justify-content:center;font-size:20px;z-index:99;opacity:0;visibility:hidden;transition:all .3s;touch-action:manipulation}
.scroll-top.visible{opacity:1;visibility:visible}
.scroll-top:active{transform:scale(.95)}
@media (max-width:640px){
  .scroll-top{width:36px;height:36px;bottom:16px;right:16px;font-size:18px}
}
</style>
</head>
<body>
  <div class="header">
    <a href="index.html" class="back-btn">‚Üê</a>
    <h1>RCF 4 - COMPLETO</h1>
    <div class="badge">136 preguntas</div>
    <div class="tabs">
      <button class="tab" id="tab_1" data-part="1">1</button>
      <button class="tab" id="tab_2" data-part="2">2</button>
      <button class="tab" id="tab_3" data-part="3">3</button>
      <button class="tab" id="tab_4" data-part="4">4</button>
    </div>
    <div class="progress-bar">
      <div class="progress-fill" id="progressBar"></div>
    </div>
  </div>
  
  <div class="container" id="questionsContainer">
    <!-- Questions will be generated here -->
  </div>

  <div class="actions">
    <div class="bar">
      <div>
        <div class="score">Puntuaci√≥n: <span id="score">‚Äî</span></div>
        <div class="score-details" id="scoreDetails"></div>
      </div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <button onclick="calificar()">üìä Calificar</button>
        <button class="secondary" onclick="reiniciar()">üîÑ Reiniciar</button>
        <button class="secondary" onclick="toggleRespuestas(this)">üëÅÔ∏è Ver respuestas</button>
      </div>
    </div>
  </div>
<button id="scrollTopBtn" class="scroll-top">‚Üë</button>
<script>
(function () {
  // Test data organized by parts (1-4)
  const testData = {
  "1": {
  "1": {
    "q": "¬øA qu√© denominar√≠amos bloqueo entre dos estaciones colaterales abiertas?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "A establecer la relaci√≥n de dependencia entre ambas, que permita expedir circulaciones de una a otra en condiciones seguras."},
      {"l": "B", "t": "A establecer la relaci√≥n de dependencia entre ambas, por medio de telefonemas, para que los Responsables de Circulaci√≥n se informen de la circulaci√≥n de los trenes en tiempo real, para que uno pueda expedir o permitir que se expida un tren, mientras el otro est√° detenido en la estaci√≥n colateral."},
      {"l": "C", "t": "A establecer un cant√≥n para que solo puede circular un tren y este, no pueda chocar o ser alcanzado por otro tren."},
      {"l": "D", "t": "A establecer la relaci√≥n de dependencia entre ambas a trav√©s de acuerdos bilaterales, que permita expedir circulaciones de una a otra en condiciones seguras."}
    ]},
  "2": {
    "q": "En cuanto a bloqueos, ¬øc√≥mo ser√° la relaci√≥n de dependencia en v√≠as con circulaci√≥n en los dos sentidos?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "La relaci√≥n entre estaciones ser√° parcial."},
      {"l": "B", "t": "La relaci√≥n entre estaciones ser√° total."},
      {"l": "C", "t": "Depende del bloqueo."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "3": {
    "q": "En cuanto a bloqueos, ¬øc√≥mo ser√° la relaci√≥n de dependencia en v√≠as con un √∫nico sentido de circulaci√≥n y sin se√±ales intermedias?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "La relaci√≥n entre estaciones ser√° parcial."},
      {"l": "B", "t": "La relaci√≥n entre estaciones ser√° total."},
      {"l": "C", "t": "Depende del bloqueo."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "4": {
    "q": "¬øCu√°les son los principios b√°sicos de los bloqueos?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Dos trenes que circulen por la misma v√≠a y en sentido contrario, ir√°n separados una distancia que garantice que no se va a producir un alcance."},
      {"l": "B", "t": "Cuando un tren est√© circulando por una v√≠a, no se expedir√° otro en el mismo sentido por la misma v√≠a desde la estaci√≥n colateral."},
      {"l": "C", "t": "Las instalaciones garantizar√°n la seguridad necesaria para compatibilizar las maniobras que se realicen por la banda de una estaci√≥n, con la llegada de un tren por dicha banda."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "5": {
    "q": "¬øQu√© instalaciones sustituyen el sistema de acuerdos bilaterales entre dos estaciones colaterales abiertas por la centralizaci√≥n en un puesto √∫nico del gobierno y control del tr√°fico?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "PLO."},
      {"l": "B", "t": "PRO."},
      {"l": "C", "t": "PM."},
      {"l": "D", "t": "CTC."}
    ]},
  "6": {
    "q": "El CTC:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Podr√° ejecutar las mismas √≥rdenes y recibir√° las mismas comprobaciones que los Cuadros de Mando Locales de los enclavamientos."},
      {"l": "B", "t": "No podr√° ejecutar las mismas √≥rdenes ni recibir√° las mismas comprobaciones que los Cuadros de Mando Locales de los enclavamientos."},
      {"l": "C", "t": "No podr√° ejecutar las mismas √≥rdenes, pero recibir√° las mismas comprobaciones que los Cuadros de Mando Locales de los enclavamientos."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "7": {
    "q": "Sin autorizaci√≥n del Responsable de Circulaci√≥n del CTC, las estaciones:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Podr√°n tomar el Mando Local de su enclavamiento y decisiones que afecten a la circulaci√≥n."},
      {"l": "B", "t": "Podr√°n tomar el Mando Local de su enclavamiento, pero no decisiones que afecten a la circulaci√≥n."},
      {"l": "C", "t": "No podr√°n tomar el Mando Local de su enclavamiento ni decisiones que afecten a la circulaci√≥n."},
      {"l": "D", "t": "No podr√°n tomar el Mando Local de su enclavamiento ni decisiones que afecten a la circulaci√≥n, salvo casos de emergencia."}
    ]},
  "8": {
    "q": "Entre otros elementos necesarios, ¬øde qu√© dispondr√° un CTC?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Telemando de los enclavamientos el√©ctricos o electr√≥nicos de las estaciones y de las agujas situadas en plena v√≠a."},
      {"l": "B", "t": "Comunicaci√≥n con los gabinetes de circulaci√≥n de las dependencias a gobernar y con los veh√≠culos motores."},
      {"l": "C", "t": "Las respuestas a) y b) son correctas."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "9": {
    "q": "¬øQui√©n podr√° gobernar los enclavamientos de las estaciones?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Por el CTC mediante el Mando Local (ML)."},
      {"l": "B", "t": "Desde los cuadros de mando de las propias estaciones mediante el Mando Centralizado (MC)."},
      {"l": "C", "t": "Las respuestas a) y b) son correctas."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "10": {
    "q": "¬øEl CTC podr√° abrir una se√±al de salida de una estaci√≥n en MC hacia una estaci√≥n en ML, sin necesidad de autorizaci√≥n de esta √∫ltima?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "S√≠, y tambi√©n al contrario."},
      {"l": "B", "t": "No, el CTC tiene que pedir autorizaci√≥n al Responsable de Circulaci√≥n de la estaci√≥n colateral por estar en ML."},
      {"l": "C", "t": "S√≠, pero no al contrario."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "11": {
    "q": "¬øUna estaci√≥n en ML podr√° abrir una se√±al de salida de una estaci√≥n en MC?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "S√≠, y tambi√©n al contrario."},
      {"l": "B", "t": "S√≠, previa autorizaci√≥n del CTC."},
      {"l": "C", "t": "No."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "12": {
    "q": "¬øQu√© son las estaciones telemandadas?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Son estaciones carentes de Responsable de Circulaci√≥n presente en la misma que no intervienen permanentemente en el bloqueo."},
      {"l": "B", "t": "Son estaciones carentes de Responsable de Circulaci√≥n presente en la misma, cuyas instalaciones son gobernadas a distancia desde otra estaci√≥n que la telemanda o desde el CTC, mediante el ML."},
      {"l": "C", "t": "Son estaciones carentes de Responsable de Circulaci√≥n presente en la misma, cuyas instalaciones son gobernadas a distancia desde otra estaci√≥n que la telemanda o desde el CTC, mediante el MC."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "13": {
    "q": "Las estaciones telemandadas:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Son estaciones carentes de Responsable de Circulaci√≥n presente en la misma que no intervienen permanentemente en el bloqueo."},
      {"l": "B", "t": "Son estaciones carentes de Responsable de Circulaci√≥n presente en la misma que intervienen permanentemente en el bloqueo, pero en ellas no pueden efectuarse maniobras."},
      {"l": "C", "t": "Son estaciones carentes de Responsable de Circulaci√≥n presente en la misma que intervienen permanentemente en el bloqueo y, en caso necesario, podr√°n ser gobernadas en ML tras incorporarse a ellas un Responsable de Circulaci√≥n."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "14": {
    "q": "¬øA qui√©n corresponde llevar a cabo la direcci√≥n y la gesti√≥n del tr√°fico ferroviario en aquellas dependencias en las que se desarrollen procesos de circulaci√≥n de trenes o maniobras?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "AI."},
      {"l": "B", "t": "AI y EF."},
      {"l": "C", "t": "EF."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "15": {
    "q": "¬øQui√©n llevar√° la direcci√≥n de la circulaci√≥n y el accionamiento de las agujas, se√±ales y dem√°s aparatos de una estaci√≥n?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "El Responsable de Circulaci√≥n de la estaci√≥n, en el caso de estaciones sin CTC, o con CTC cuando funcionen en ML."},
      {"l": "B", "t": "El Responsable de Circulaci√≥n del CTC, cuando la estaci√≥n funcione en MC."},
      {"l": "C", "t": "En una estaci√≥n telemandada en MC, el Responsable de Circulaci√≥n de la estaci√≥n que la gobierna."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "16": {
    "q": "¬øQui√©n llevar√° la direcci√≥n de la circulaci√≥n y el accionamiento de las agujas, se√±ales y dem√°s aparatos de los cantones situados entre dos estaciones colaterales abiertas?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "El Responsable de Circulaci√≥n del CTC, cuando las estaciones colaterales est√©n en MC, o bien, una en MC y la otra en ML."},
      {"l": "B", "t": "Los Responsables de Circulaci√≥n de las estaciones colaterales, cuando ambas est√©n en ML."},
      {"l": "C", "t": "Cuando las estaciones colaterales pertenezcan a CTCs distintos y est√©n ambas en MC, cada una estar√° a cargo del Responsables de Circulaci√≥n del CTC correspondiente."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "17": {
    "q": "¬øEl Responsable de Circulaci√≥n de una estaci√≥n en ML podr√° delegar sus funciones en el Responsable de Circulaci√≥n del CTC, o en el de otra estaci√≥n que disponga de telemando sobre la primera?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "No, una vez se establece el ML de una estaci√≥n no se puede devolver a MC."},
      {"l": "B", "t": "S√≠, pero solo en el caso de CTC."},
      {"l": "C", "t": "S√≠, si las circunstancias lo aconsejan."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "18": {
    "q": "¬øQui√©n colaborar√° con el Responsable de Circulaci√≥n del CTC o de la estaci√≥n que telemande con objeto de asegurar las maniobras en v√≠as de circulaci√≥n, la entrada o salida de v√≠as o l√≠neas no dependientes del CTC, comunicar la llegada o apartado de trenes y transmitir sus √≥rdenes?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "El Responsable de Circulaci√≥n de la estaci√≥n."},
      {"l": "B", "t": "El Auxiliar de Circulaci√≥n."},
      {"l": "C", "t": "El Maquinista."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "19": {
    "q": "¬øEl Responsable de Circulaci√≥n del CTC podr√° ordenar a los Responsables de Circulaci√≥n de las estaciones la toma del ML?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "S√≠, sin tener que dar ninguna explicaci√≥n."},
      {"l": "B", "t": "No, una estaci√≥n telemandada no puede gobernarse mediante ML."},
      {"l": "C", "t": "S√≠, en ciertos casos, despu√©s de informarles de la situaci√≥n de los trenes."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "20": {
    "q": "Cuando cesen las causas que motivaron la toma del ML de una estaci√≥n, ¬øel Responsable de Circulaci√≥n del CTC se har√° cargo nuevamente del MC?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "S√≠, de manera inmediata."},
      {"l": "B", "t": "No, una vez entregado el ML no se puede volver a gobernar mediante el MC."},
      {"l": "C", "t": "S√≠, previa informaci√≥n de la situaci√≥n de los trenes."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "21": {
    "q": "En los trayectos entre estaciones en ML, ¬øse dar√° informaci√≥n a los Maquinistas de esta circunstancia?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "S√≠, puesto que esta informaci√≥n no aparece en su Libro de Itinerarios."},
      {"l": "B", "t": "S√≠, puesto que condiciona la circulaci√≥n de los trenes."},
      {"l": "C", "t": "No, puesto que se mantiene la circulaci√≥n al amparo del bloqueo de la l√≠nea con CTC."},
      {"l": "D", "t": "No, puesto que esta informaci√≥n aparece en su Libro de Itinerarios."}
    ]},
  "22": {
    "q": "El Responsable de Circulaci√≥n de una estaci√≥n en entorno de CTC: ¬øse abstendr√° de tomar el ML sin orden expresa del Responsable de Circulaci√≥n del CTC?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Podr√° tomar el ML sin orden expresa del Responsable de Circulaci√≥n del CTC."},
      {"l": "B", "t": "Se abstendr√° de tomar el ML sin orden expresa del Responsable de Circulaci√≥n del CTC, incluso por emergencia."},
      {"l": "C", "t": "Se abstendr√° de tomar el ML sin orden expresa del Responsable de Circulaci√≥n del CTC, salvo por emergencia."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "23": {
    "q": "En los bloqueos autom√°ticos, ¬øc√≥mo ser√° la relaci√≥n de dependencia en v√≠as con circulaci√≥n en los dos sentidos?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Total."},
      {"l": "B", "t": "Parcial."},
      {"l": "C", "t": "Ninguna es correcta."},
      {"l": "D", "t": "Depende del bloqueo."}
    ]},
  "24": {
    "q": "En los bloqueos autom√°ticos, ¬øc√≥mo ser√° la relaci√≥n de dependencia en v√≠as con un √∫nico sentido de circulaci√≥n y sin se√±ales intermedias?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Total."},
      {"l": "B", "t": "Parcial."},
      {"l": "C", "t": "Ninguna es correcta."},
      {"l": "D", "t": "Depende del bloqueo."}
    ]},
  "25": {
    "q": "En los bloqueos autom√°ticos, ¬øc√≥mo queda garantizada la relaci√≥n de dependencia entre estaciones?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Mediante petici√≥n y concesi√≥n de v√≠a mediante telefonema."},
      {"l": "B", "t": "Mediante petici√≥n y toma de v√≠a mediante cuadro el√©ctrico-manual."},
      {"l": "C", "t": "Por la propia naturaleza de la instalaci√≥n."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "26": {
    "q": "En bloqueo autom√°tico, para expedir o dar paso a un tren no es preciso que:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "El cant√≥n de bloqueo est√© libre de trenes."},
      {"l": "B", "t": "En BAU y BAB, se haya bloqueado el cant√≥n de bloqueo, con los dispositivos disponibles al efecto."},
      {"l": "C", "t": "Se haya establecido el itinerario de salida."},
      {"l": "D", "t": "Se d√© la orden de marcha con la orden de la se√±al de salida y la se√±al de marche el tren."}
    ]},
  "27": {
    "q": "¬øC√≥mo se dar√° la orden de marcha a un tren que detiene su marcha en una estaci√≥n debido a un problema de frenado, siendo necesario aislar el freno de un veh√≠culo remolcado, en un trayecto con bloqueo autom√°tico sin CTC?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida."},
      {"l": "B", "t": "Con la orden de la se√±al de salida y la se√±al de paso."},
      {"l": "C", "t": "Con la orden de la se√±al de salida y la se√±al de marche el tren."},
      {"l": "D", "t": "Con la orden de la se√±al de salida y la se√±al de operaciones terminadas por el agente que corresponda."}
    ]},
  "28": {
    "q": "Un tren circula por un trayecto de BAD sin CTC, comprendido por las estaciones A, B, C y D. Para la estaci√≥n C, el tren es directo, y en una bifurcaci√≥n de esa estaci√≥n toma una l√≠nea de BAU con CTC. ¬øC√≥mo se le dar√° orden de marcha en la estaci√≥n C?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida y la se√±al de paso."},
      {"l": "B", "t": "Con la orden de la se√±al de salida."},
      {"l": "C", "t": "Con la se√±al de marche el tren y la orden de la se√±al de salida."},
      {"l": "D", "t": "Con la se√±al de paso."}
    ]},
  "29": {
    "q": "La orden de marcha a un tren directo en una estaci√≥n de transici√≥n de BAU sin CTC a BAU con CTC se dar√°:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida y la se√±al de paso."},
      {"l": "B", "t": "Con la orden de la se√±al de salida."},
      {"l": "C", "t": "Con la se√±al de marche el tren y la orden de la se√±al de salida."},
      {"l": "D", "t": "Con la se√±al de paso."}
    ]},
  "30": {
    "q": "Cuando deban expedir un tren parado en BAU sin CT hacia un BT, la orden de marcha se dar√°:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida."},
      {"l": "B", "t": "Con la orden de la se√±al de salida y la se√±al de marche tren."},
      {"l": "C", "t": "Con la orden de la se√±al de salida y telefonema."},
      {"l": "D", "t": "No se le dar√° la orden de marcha."}
    ]},
  "31": {
    "q": "Cuando un tren directo pase de un BAU sin CTC hacia un BT, la orden de marcha se dar√°:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida."},
      {"l": "B", "t": "Con la orden de la se√±al de salida y la se√±al de marche tren."},
      {"l": "C", "t": "Con la orden de la se√±al de salida y se√±al de paso."},
      {"l": "D", "t": "No se le dar√° la orden de marcha."}
    ]},
  "32": {
    "q": "En un trayecto de BA sin CTC, ¬øc√≥mo se dar√° la orden de marcha a un tren parado porque se haya modificado su composici√≥n?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida."},
      {"l": "B", "t": "Con la orden de la se√±al de salida complementada con la se√±al de paso."},
      {"l": "C", "t": "Con la orden de la se√±al de salida complementada con la se√±al de marche el tren."},
      {"l": "D", "t": "Con la orden de la se√±al de salida complementada con la indicaci√≥n de operaciones terminadas."}
    ]},
  "33": {
    "q": "En una estaci√≥n de BAU sin CTC, a un tren directo se dar√° la orden con:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "La orden de la se√±al de salida y la se√±al de marche tren."},
      {"l": "B", "t": "La orden de la se√±al de salida y la se√±al de paso."},
      {"l": "C", "t": "La orden de la se√±al de salida."},
      {"l": "D", "t": "La orden de la se√±al de paso."}
    ]},
  "34": {
    "q": "En un trayecto de BAU sin CTC, a un tren saliendo de origen se dar√° la orden de marcha con:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "La orden de la se√±al de salida en v√≠a libre o rebase autorizado."},
      {"l": "B", "t": "La orden de la se√±al de salida y la se√±al de marche tren."},
      {"l": "C", "t": "La orden de la se√±al de salida."},
      {"l": "D", "t": "No se le dar√° la orden de marcha."}
    ]
  }
},
  "2": {
  "35": {
    "q": "¬øC√≥mo se da la orden de marcha a un tren en BA sin CTC en una estaci√≥n a partir de la cual est√° establecida la BTV, si el tren circula por su v√≠a y funcionan las se√±ales?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Si el tren es directo, con la se√±al de paso ya que la se√±al de salida es inexistente."},
      {"l": "B", "t": "Si el tren es directo, con la se√±al de paso y la se√±al de salida abierta."},
      {"l": "C", "t": "Con la se√±al de salida, siempre que no ordene parada."},
      {"l": "D", "t": "Si el tren est√° parado, con la se√±al de marche el tren."}
    ]},
  "36": {
    "q": "En un trayecto de BA, ¬øc√≥mo se da la orden de marcha a un tren en una estaci√≥n en la que se le ha segregado un vag√≥n?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida."},
      {"l": "B", "t": "Con la orden de la se√±al de salida y la se√±al de paso."},
      {"l": "C", "t": "Con la orden de la se√±al de salida y la se√±al de marche el tren."},
      {"l": "D", "t": "Por escrito o telefonema."}
    ]},
  "37": {
    "q": "¬øC√≥mo se dar√° la orden de marcha a un tren detenido en una estaci√≥n de BA que vaya a circular hacia un BT?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Con la orden de la se√±al de salida y la se√±al de marche tren."},
      {"l": "B", "t": "Con la orden de la se√±al de marche tren."},
      {"l": "C", "t": "Con la orden de la se√±al de salida."},
      {"l": "D", "t": "Con la orden de la se√±al de salida y la se√±al de paso."}
    ]},
  "38": {
    "q": "Entre las estaciones A y B existe BA sin CTC y entre B y C existe BA con CTC. ¬øDebe presentarse la se√±al de paso en la estaci√≥n B para un tren de paso que va a circular a v√≠a desviada?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Hay que presentarla por tratarse de una transici√≥n de bloqueo."},
      {"l": "B", "t": "No debe presentarse, ya que en BA la orden de marcha se da con la orden de la se√±al de salida."},
      {"l": "C", "t": "Si dispone de personal de circulaci√≥n, hay que presentarla."},
      {"l": "D", "t": "Hay que presentarla cuando se suprima la parada t√©cnica."}
    ]},
  "39": {
    "q": "En bloqueo autom√°tico, ¬øest√° permitida la expedici√≥n de trenes desde v√≠as sin se√±al de salida?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Solo en BAU."},
      {"l": "B", "t": "Solo en BAB."},
      {"l": "C", "t": "En BAU y BAB."},
      {"l": "D", "t": "No est√° permitida ni en BAU ni en BAB."}
    ]},
  "40": {
    "q": "La expedici√≥n de trenes en BAU y BAB sin CTC, de v√≠as que no tengan se√±al de salida:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "No est√° permitida."},
      {"l": "B", "t": "Se realizar√° dando la orden de marcha con la se√±al de marche el tren."},
      {"l": "C", "t": "Se realizar√° dando la orden de marcha con la se√±al de marche el tren despu√©s de observar que alguna otra se√±al de salida del mismo lado ordena v√≠a libre y estableciendo el itinerario de la v√≠a correspondiente."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "41": {
    "q": "En BAB sin CTC, ¬øse puede expedir tren desde una v√≠a sin se√±al de salida?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "S√≠, se realizar√° dando la orden de marcha con la se√±al de marche el tren despu√©s de observar que alguna otra se√±al de salida del mismo lado ordena v√≠a libre y estableciendo el itinerario de la v√≠a correspondiente."},
      {"l": "B", "t": "No est√° permitida la expedici√≥n de trenes en este caso."},
      {"l": "C", "t": "S√≠, se realizar√° dando la orden de marcha con la se√±al de marche el tren."},
      {"l": "D", "t": "S√≠, si lo autoriza el PM."}
    ]},
  "42": {
    "q": "Para expedir un tren en BAD sin CTC desde una v√≠a sin se√±al de salida, es condici√≥n indispensable:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Que alguna otra se√±al de salida del mismo lado no ordene parada, comprob√°ndose por observaci√≥n directa."},
      {"l": "B", "t": "Que alguna otra se√±al de salida del mismo lado ordene v√≠a libre, comprob√°ndose por observaci√≥n directa."},
      {"l": "C", "t": "En BAD no est√° permitida la expedici√≥n de trenes desde v√≠as sin se√±al de salida."},
      {"l": "D", "t": "Que alguna otra se√±al de salida del mismo lado ordene v√≠a libre, comprob√°ndose en los visores de los cuadros de mando."}
    ]},
  "43": {
    "q": "Para expedir un tren en BAD con CTC en ML desde una v√≠a sin se√±al de salida, es condici√≥n indispensable:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Que alguna otra se√±al de salida del mismo lado no ordene parada, comprob√°ndose por observaci√≥n directa."},
      {"l": "B", "t": "Que alguna otra se√±al de salida del mismo lado ordene v√≠a libre, comprob√°ndose por observaci√≥n directa."},
      {"l": "C", "t": "En BAD no est√° permitida la expedici√≥n de trenes desde v√≠as sin se√±al de salida."},
      {"l": "D", "t": "Que alguna otra se√±al de salida del mismo lado ordene v√≠a libre, comprob√°ndose en los visores de los cuadros de mando."}
    ]},
  "44": {
    "q": "Para expedir un tren en BAD con CTC desde una v√≠a sin se√±al de salida, es condici√≥n indispensable:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Que alguna otra se√±al de salida del mismo lado ordene v√≠a libre, comprob√°ndose por observaci√≥n directa."},
      {"l": "B", "t": "En BAD no est√° permitida la expedici√≥n de trenes desde v√≠as sin se√±al de salida."},
      {"l": "C", "t": "Que una persona habilitada colabore con el Responsable de Circulaci√≥n del CTC para garantizar la correcta disposici√≥n de los aparatos que no puedan ser telemandados."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "45": {
    "q": "En condiciones normales, ¬øest√° permitida la expedici√≥n de trenes desde v√≠as sin se√±al de salida?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Solo en BAU y BAD."},
      {"l": "B", "t": "Solo en BAD con CTC."},
      {"l": "C", "t": "Solo en BAU."},
      {"l": "D", "t": "En BAD."}
    ]},
  "46": {
    "q": "Cuando en BAD sin CTC, se expida un tren desde una v√≠a sin se√±al de salida:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "El Maquinista circular√° al amparo del BT por anormalidad, sin necesidad de orden de marcha."},
      {"l": "B", "t": "El Maquinista circular√° al amparo del BT por anormalidad por lo que se le dar√° la se√±al de marche tren."},
      {"l": "C", "t": "El Maquinista circular√° al amparo del BA despu√©s de presentarle la se√±al de marche el tren."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "47": {
    "q": "En BAU sin CTC, ¬øse puede expedir un tren de una v√≠a sin se√±al de salida?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "No."},
      {"l": "B", "t": "S√≠, comprobando que alguna otra se√±al de salida del mismo lado ordena v√≠a libre."},
      {"l": "C", "t": "S√≠, basta con la se√±al de marche tren."},
      {"l": "D", "t": "S√≠, si lo autoriza el PM."}
    ]},
  "48": {
    "q": "En BAD sin CTC, un tren sale de una estaci√≥n desde una v√≠a sin se√±al de salida. ¬øCon qu√© condiciones de circulaci√≥n ir√° el Maquinista?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Circular√° hasta la estaci√≥n siguiente al amparo del BA."},
      {"l": "B", "t": "Circular√° con marcha a la vista hasta la primera se√±al de bloqueo."},
      {"l": "C", "t": "Circular√° con marcha de maniobras hasta la primera se√±al de bloqueo."},
      {"l": "D", "t": "Circular√° con marcha normal."}
    ]},
  "49": {
    "q": "¬øC√≥mo actuar√° el Responsable de Circulaci√≥n del CTC cuando deba expedir un tren desde v√≠as sin se√±al de salida, si el AI ha dispuesto una persona habilitada que colabore con √©l?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Establecer√° la parte que telemanda del itinerario de acceso a la v√≠a general y recibir√° conformidad del personal responsable del establecimiento del resto del itinerario."},
      {"l": "B", "t": "Cursar√° al Maquinista el telefonema: ¬´Marche el tren (n.¬∫ de tren) hasta (estaci√≥n inmediata) con marcha a la vista hasta la se√±al (primera de bloqueo)¬ª."},
      {"l": "C", "t": "Ordenar√° al personal reponer los aparatos a su posici√≥n normal una vez expedido el tren."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "50": {
    "q": "En caso de anormalidad en el funcionamiento de los bloqueos autom√°ticos (BAU, BAD, BAB):",
    "a": "C",
    "opts": [
      {"l": "A", "t": "En cualquier caso, se establecer√° el BT en el trayecto y v√≠as autorizados."},
      {"l": "B", "t": "En caso de anormalidad debe suspenderse la circulaci√≥n hasta que se restablezca el bloqueo."},
      {"l": "C", "t": "Se podr√° establecer el BT en el trayecto y v√≠as autorizados siempre que el Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM lo autorice expresamente."},
      {"l": "D", "t": "Se podr√° establecer el BT en el trayecto y v√≠as autorizados siempre que el Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM o del CTC lo autorice expresamente."}
    ]},
  "51": {
    "q": "Si existe anormalidad en el funcionamiento de la se√±al de salida en BAB sin CTC, ¬øcu√°ndo se podr√° seguir circulando?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Se seguir√° circulando al amparo del BT."},
      {"l": "B", "t": "Cuando se autorice el rebase de dicha se√±al, mediante un BOI, con marcha a la vista hasta la se√±al siguiente."},
      {"l": "C", "t": "Si funcionan los dispositivos de bloqueo, el Responsable de Circulaci√≥n de la estaci√≥n podr√° autorizar el rebase de dicha se√±al, seg√∫n lo dispuesto en el RCF, una vez que haya informado de esta situaci√≥n a su colateral y haya recibido la conformidad de este de no expedir trenes por dicha v√≠a hasta nuevo aviso."},
      {"l": "D", "t": "Si funcionan los dispositivos de bloqueo, se podr√° continuar la circulaci√≥n al amparo del BA cuando el Responsable de Circulaci√≥n haya informado de esta situaci√≥n a su colateral."}
    ]},
  "52": {
    "q": "En BAD sin CTC, se establecer√° el bloqueo telef√≥nico por anormalidad:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Cuando no funcionen las se√±ales de salida."},
      {"l": "B", "t": "Cuando no funcionen normalmente una o varias se√±ales."},
      {"l": "C", "t": "Cuando el Responsable de Circulaci√≥n de la Banda del PM lo convenga."},
      {"l": "D", "t": "Cuando no funcionen las se√±ales de bloqueo o los dispositivos de bloqueo."}
    ]},
  "53": {
    "q": "En BAD con CTC, se establecer√° el bloqueo telef√≥nico por anormalidad:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Cuando no funcionen las se√±ales de salida."},
      {"l": "B", "t": "Cuando no funcionen normalmente una o varias se√±ales."},
      {"l": "C", "t": "Cuando el Responsable de Circulaci√≥n de la Banda del PM lo convenga."},
      {"l": "D", "t": "Cuando no funcionen las se√±ales de bloqueo o los dispositivos de bloqueo."}
    ]},
  "54": {
    "q": "En BAU con CTC, se establecer√° el bloqueo telef√≥nico por anormalidad:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Cuando no funcionen las se√±ales de salida."},
      {"l": "B", "t": "Cuando no funcionen normalmente una o varias se√±ales."},
      {"l": "C", "t": "Cuando el Responsable de Circulaci√≥n del CTC lo convenga."},
      {"l": "D", "t": "Cuando no funcionen las se√±ales de bloqueo o los dispositivos de bloqueo."}
    ]},
  "55": {
    "q": "En BAB con CTC, se establecer√° el bloqueo telef√≥nico por anormalidad:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Cuando no funcionen las se√±ales de salida."},
      {"l": "B", "t": "Cuando no funcionen normalmente una o varias se√±ales."},
      {"l": "C", "t": "Cuando el Responsable de Circulaci√≥n del CTC lo convenga."},
      {"l": "D", "t": "Cuando no funcionen las se√±ales de bloqueo o los dispositivos de bloqueo."}
    ]},
  "56": {
    "q": "¬øC√≥mo queda garantizada la relaci√≥n de dependencia entre estaciones en el bloqueo de se√±alizaci√≥n lateral?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Mediante petici√≥n y concesi√≥n de v√≠a mediante telefonema."},
      {"l": "B", "t": "Mediante petici√≥n y toma de v√≠a mediante cuadro el√©ctrico-manual."},
      {"l": "C", "t": "Por la propia naturaleza de la instalaci√≥n."},
      {"l": "D", "t": "Por las indicaciones que presentan las se√±ales que protegen los cantones y que mantienen la distancia de seguridad entre trenes."}
    ]},
  "57": {
    "q": "En BSL, ¬øqu√© indicaci√≥n no pueden dar las se√±ales avanzadas?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Pueden dar todas las indicaciones."},
      {"l": "B", "t": "Anuncio de parada."},
      {"l": "C", "t": "Parada."},
      {"l": "D", "t": "V√≠a libre."}
    ]},
  "58": {
    "q": "En BSL, ¬øqu√© indicaci√≥n no pueden dar las se√±ales de salida?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Pueden dar todas las indicaciones."},
      {"l": "B", "t": "Anuncio de parada."},
      {"l": "C", "t": "Parada."},
      {"l": "D", "t": "V√≠a libre."}
    ]},
  "59": {
    "q": "¬øCu√°ndo se aplica el BSL?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "En l√≠neas de alta velocidad cuando el ATP vinculado al BCA no funcione con normalidad o tenga que circular un tren no equipado o con el equipo embarcado del ATP averiado."},
      {"l": "B", "t": "En l√≠neas de alta velocidad cuando el ATP vinculado al BCA funcione con normalidad, como bloqueo supletorio."},
      {"l": "C", "t": "En l√≠neas convencionales cuando el ATP vinculado al BCA no funcione con normalidad o tenga que circular un tren no equipado o con el equipo embarcado del ATP averiado."},
      {"l": "D", "t": "En l√≠neas convencionales cuando el ATP vinculado al BCA no funcione con normalidad y tengan que circular con ASFA."}
    ]},
  "60": {
    "q": "Para expedir o dar paso a un tren en BSL es preciso que:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "El trayecto est√© libre de trenes."},
      {"l": "B", "t": "No existan movimientos de maniobras autorizados por la otra v√≠a, afectando al mismo trayecto, en estaciones colaterales."},
      {"l": "C", "t": "Se haya bloqueado el cant√≥n de bloqueo mediante los dispositivos disponibles al efecto y se haya establecido el itinerario de salida."},
      {"l": "D", "t": "Se d√© la orden de marcha con la orden de la se√±al de salida y la se√±al de marche el tren o se√±al de paso, seg√∫n proceda."}
    ]},
  "61": {
    "q": "En BSL, en el caso de anormalidad en las se√±ales de salida o en las se√±ales de los PB, bifurcaciones o PCA, ¬øel Responsable de Circulaci√≥n podr√° autorizar el rebase de las mismas una vez que el cant√≥n de bloqueo est√© libre de trenes?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "S√≠, con marcha a la vista hasta la siguiente se√±al de bloqueo."},
      {"l": "B", "t": "S√≠, con marcha a la vista hasta la siguiente estaci√≥n."},
      {"l": "C", "t": "S√≠, con marcha normal."},
      {"l": "D", "t": "No."}
    ]},
  "62": {
    "q": "En caso de anormalidad en BSL, ¬øc√≥mo har√° el Responsable de Circulaci√≥n para comprobar que el cant√≥n de bloqueo se encuentra libre?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Por observaci√≥n directa del √∫ltimo tren que circul√≥."},
      {"l": "B", "t": "Solicitando al Maquinista del √∫ltimo tren que circul√≥ la confirmaci√≥n de llegada, paso o apartado en la estaci√≥n mediante la radiotelefon√≠a."},
      {"l": "C", "t": "Solicitando al Maquinista del √∫ltimo tren que circul√≥ la confirmaci√≥n de llegada, paso o apartado en la estaci√≥n mediante el telefonema: ¬´Tren (n.¬∫ de tren) lleg√≥ completo y apartado en (v√≠a de apartado)¬ª."},
      {"l": "D", "t": "Con la informaci√≥n aportada por los contadores de ejes."}
    ]},
  "63": {
    "q": "¬øC√≥mo queda garantizada la relaci√≥n de dependencia entre estaciones en BCA?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Por la existencia de instalaciones que controlan que la distancia de seguridad entre trenes se mantiene, regulando la velocidad de modo que ninguno supere la Velocidad L√≠mite, y garantizando la existencia de un solo tren en cada cant√≥n de bloqueo."},
      {"l": "B", "t": "Por la existencia de instalaciones que controlan que la distancia de seguridad entre trenes se mantiene, regulando la velocidad de modo que ninguno supere la velocidad m√°xima, y garantizando la existencia de un solo tren en cada cant√≥n de bloqueo."},
      {"l": "C", "t": "Por la propia naturaleza de la instalaci√≥n."},
      {"l": "D", "t": "Por las indicaciones que presentan las se√±ales que protegen los cantones y que mantienen la distancia de seguridad entre trenes."}
    ]},
  "64": {
    "q": "El BCA est√° vinculado a la circulaci√≥n de trenes con alguno de los sistemas de protecci√≥n autom√°tica de trenes (ATP) en servicio:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "ERTMS/ETCS nivel 1 o 2."},
      {"l": "B", "t": "ERTMS/ETCS nivel 1 o 2 y LZB."},
      {"l": "C", "t": "ERTMS/ETCS nivel 1 o 2, LZB y EBICAB."},
      {"l": "D", "t": "LZB."}
    ]},
  "65": {
    "q": "Para expedir o dar paso a un tren en BCA, no es preciso que:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "El cant√≥n de bloqueo est√© libre de trenes."},
      {"l": "B", "t": "Se haya bloqueado el cant√≥n de bloqueo mediante los dispositivos disponibles al efecto."},
      {"l": "C", "t": "Se haya establecido el itinerario de salida o paso."},
      {"l": "D", "t": "Se d√© la orden de marcha con la orden de la se√±al de salida."}
    ]},
  "66": {
    "q": "Si se detectan irregularidades en el funcionamiento del BCA, se continuar√° la circulaci√≥n con:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "BSL."},
      {"l": "B", "t": "BA."},
      {"l": "C", "t": "BT."},
      {"l": "D", "t": "No se puede continuar la circulaci√≥n."}
    ]},
  "67": {
    "q": "Si el ATP con el que circule el tren provocara el frenado y detenci√≥n del mismo:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "El Maquinista informar√° al Responsable de Circulaci√≥n del CTC, que en su caso autorizar√° la reanudaci√≥n de la marcha en las condiciones espec√≠ficas de circulaci√≥n que procedan hasta la se√±al siguiente y al amparo del BSL."},
      {"l": "B", "t": "El Maquinista informar√° al Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM, que en su caso autorizar√° la reanudaci√≥n de la marcha en las condiciones espec√≠ficas de circulaci√≥n que procedan hasta la se√±al siguiente y al amparo del BSL."},
      {"l": "C", "t": "El Maquinista informar√° al Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM, que en su caso autorizar√° la reanudaci√≥n de la marcha al amparo del BSL con marcha a la vista hasta la siguiente se√±al de bloqueo."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "68": {
    "q": "Si tras una detenci√≥n provocada por el ATP, este vuelve a funcionar:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "El Maquinista informar√° al Responsable de Circulaci√≥n del CTC, que en su caso autorizar√° la reanudaci√≥n de la marcha en las condiciones espec√≠ficas de circulaci√≥n que procedan hasta la se√±al siguiente y al amparo del BSL."},
      {"l": "B", "t": "El Maquinista informar√° al Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM, que en su caso autorizar√° la reanudaci√≥n de la marcha en las condiciones espec√≠ficas de circulaci√≥n que procedan hasta la se√±al siguiente y al amparo del BSL."},
      {"l": "C", "t": "El Maquinista circular√° nuevamente, a partir de la se√±al siguiente, con este sistema y lo comunicar√° al Responsable de Circulaci√≥n del CTC."},
      {"l": "D", "t": "El Maquinista circular√° nuevamente, a partir de la se√±al siguiente, con este sistema y lo comunicar√° al Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM."}
    ]}
},

  "3": {
  "69": {
    "q": "En caso de aver√≠a, el Responsable de Circulaci√≥n podr√° disponer que todos los trenes circulen con BSL entre dos estaciones:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "En estas condiciones, se notificar√° al Maquinista de cada tren la conexi√≥n del ASFA."},
      {"l": "B", "t": "En estas condiciones, se notificar√° al Maquinista de cada tren la conexi√≥n del ATP vinculado al BCA."},
      {"l": "C", "t": "En estas condiciones, se notificar√° al Maquinista de cada tren la desconexi√≥n del ATP vinculado al BCA."},
      {"l": "D", "t": "Sin necesidad de notificaci√≥n a los Maquinistas."}
    ]},
  "70": {
    "q": "¬øC√≥mo queda garantizada la relaci√≥n de dependencia entre estaciones en BLA?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Mediante petici√≥n y concesi√≥n de v√≠a mediante telefonema."},
      {"l": "B", "t": "Mediante petici√≥n y toma de v√≠a mediante cuadro el√©ctrico-manual."},
      {"l": "C", "t": "Por la propia naturaleza de la instalaci√≥n."},
      {"l": "D", "t": "Por las indicaciones que presentan las se√±ales que protegen los cantones y que mantienen la distancia de seguridad entre trenes."}
    ]},
  "71": {
    "q": "Las se√±ales intermedias en el BLA, ¬øest√°n dotadas de la letra \"P\"?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "S√≠."},
      {"l": "B", "t": "S√≠ y algunas se√±ales avanzadas."},
      {"l": "C", "t": "No, las se√±ales intermedias en BLA son absolutas."},
      {"l": "D", "t": "No, no existen intermedias en el BLA."}
    ]},
  "72": {
    "q": "En l√≠neas de BLA con velocidades inferiores a 160 km/h, ¬øpodr√° existir una se√±al de preavanzada?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "S√≠ y podr√° dar indicaciones de v√≠a libre y v√≠a libre condicional."},
      {"l": "B", "t": "S√≠ y podr√° dar indicaciones de v√≠a libre y anuncio de parada."},
      {"l": "C", "t": "S√≠ y podr√° dar todas las indicaciones."},
      {"l": "D", "t": "No."}
    ]},
  "73": {
    "q": "En l√≠neas con velocidades inferiores a 160 km/h, ¬øpodr√° existir una se√±al de preavanzada?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "S√≠, en BT."},
      {"l": "B", "t": "S√≠, en BLA."},
      {"l": "C", "t": "S√≠, en cualquier bloqueo."},
      {"l": "D", "t": "No."}
    ]},
  "74": {
    "q": "En l√≠neas de BLA con velocidades superiores a 160 km/h, ¬øpodr√° existir una se√±al de preavanzada?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "S√≠ y podr√° dar indicaciones de v√≠a libre y v√≠a libre condicional."},
      {"l": "B", "t": "S√≠ y podr√° dar indicaciones de v√≠a libre y anuncio de parada."},
      {"l": "C", "t": "S√≠ y podr√° dar todas las indicaciones."},
      {"l": "D", "t": "No."}
    ]},
  "75": {
    "q": "En l√≠neas con velocidades superiores a 160 km/h, ¬øpodr√° existir una se√±al de preavanzada?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "S√≠, en BT."},
      {"l": "B", "t": "S√≠, en BLA."},
      {"l": "C", "t": "S√≠, en cualquier bloqueo."},
      {"l": "D", "t": "No."}
    ]},
  "76": {
    "q": "¬øQu√© indicaciones no pueden presentar las se√±ales avanzada en el BLA?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Anuncio de parada."},
      {"l": "B", "t": "Parada."},
      {"l": "C", "t": "V√≠a libre."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "77": {
    "q": "¬øQu√© indicaciones no pueden presentar las se√±ales de salida en el BLA?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Anuncio de parada."},
      {"l": "B", "t": "Parada."},
      {"l": "C", "t": "V√≠a libre."},
      {"l": "D", "t": "V√≠a libre condicional."}
    ]},
  "78": {
    "q": "¬øC√≥mo actuar√° el Maquinista cuando se detenga accidentalmente despu√©s de haber franqueado una se√±al de preavanzada en un BA?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Al reanudar la marcha proceder√° como si la hubiese encontrado en indicaci√≥n de v√≠a libre."},
      {"l": "B", "t": "Al reanudar la marcha proceder√° como si la hubiese encontrado en indicaci√≥n de v√≠a libre condicional."},
      {"l": "C", "t": "Al reanudar la marcha proceder√° como si la hubiese encontrado en indicaci√≥n de anuncio de parada."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "79": {
    "q": "¬øC√≥mo actuar√° el Maquinista cuando se detenga accidentalmente despu√©s de haber franqueado una se√±al de preavanzada en un BLA?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Cuando el Maquinista se detenga accidentalmente despu√©s de haberla franqueado, al reanudar la marcha proceder√° como si la hubiese encontrado en indicaci√≥n de v√≠a libre condicional."},
      {"l": "B", "t": "Cuando el Maquinista se detenga accidentalmente despu√©s de haberla franqueado, al reanudar la marcha proceder√° como si la hubiese encontrado en indicaci√≥n de anuncio de parada."},
      {"l": "C", "t": "Cuando el Maquinista se detenga accidentalmente despu√©s de haberla franqueado, al reanudar la marcha proceder√° como si la hubiese encontrado en indicaci√≥n de v√≠a libre."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "80": {
    "q": "Para expedir o dar paso a un tren, BLA no es preciso que:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "El cant√≥n de bloqueo est√© libre de trenes. Adem√°s, que en BLAU y BLAB, se haya bloqueado el cant√≥n de bloqueo, con los dispositivos disponibles al efecto."},
      {"l": "B", "t": "Se haya establecido el itinerario de salida."},
      {"l": "C", "t": "Se d√© la orden de marcha con la orden de la se√±al de salida y la se√±al de marche tren y se√±al de paso, seg√∫n proceda."},
      {"l": "D", "t": "No est√° permitida la expedici√≥n de trenes desde v√≠as sin se√±al de salida."}
    ]},
  "81": {
    "q": "Si no funciona la se√±al de salida en un BLA sin CTC, ¬øc√≥mo proceder√° el Responsable de Circulaci√≥n de la estaci√≥n?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "En cualquier caso, autorizar√° al Maquinista el rebase de la se√±al con marcha normal."},
      {"l": "B", "t": "En cualquier caso, autorizar√° al Maquinista el rebase de la se√±al con marcha a la vista."},
      {"l": "C", "t": "Excepcionalmente, si funcionan los dispositivos de bloqueo, autorizar√° el rebase de la se√±al de salida."},
      {"l": "D", "t": "Excepcionalmente, en BLAD, si funcionan los dispositivos de bloqueo, autorizar√° el rebase de la se√±al de salida."}
    ]},
  "82": {
    "q": "En BLA, si no funciona la se√±al de salida en el trayecto entre una estaci√≥n y la siguiente estaci√≥n telemandada por la primera, ¬øc√≥mo proceder√° el Responsable de Circulaci√≥n?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Establecer√° el BT entre ambas estaciones."},
      {"l": "B", "t": "El Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM ponderar√° si conviene o no establecer el BT."},
      {"l": "C", "t": "El Responsable de Circulaci√≥n del CTC ponderar√° si conviene o no establecer el BT."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "83": {
    "q": "En BLA, si falla la se√±al de salida en √°mbito de CTC y se mantiene la circulaci√≥n al amparo del BLA, para expedir trenes ser√° necesario que:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "El cant√≥n de bloqueo est√© libre de trenes, y autorizar el rebase de la se√±al de salida."},
      {"l": "B", "t": "El Responsable de Circulaci√≥n del CTC establecer√° por defecto el BT."},
      {"l": "C", "t": "El Responsable de Circulaci√≥n del CTC autorice el rebase de la se√±al de salida con marcha a la vista."},
      {"l": "D", "t": "El Responsable de Circulaci√≥n de la estaci√≥n autorice el rebase de la se√±al de salida con marcha a la vista."}
    ]},
  "84": {
    "q": "¬øC√≥mo queda garantizada la relaci√≥n de dependencia entre estaciones en los BT?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Mediante acuerdos bilaterales entre sus Responsables de Circulaci√≥n para concertar la circulaci√≥n de trenes entre ambas."},
      {"l": "B", "t": "Mediante petici√≥n y concesi√≥n de v√≠a mediante BOI."},
      {"l": "C", "t": "Mediante petici√≥n y toma de v√≠a mediante cuadro el√©ctrico-manual."},
      {"l": "D", "t": "Por la propia naturaleza de la instalaci√≥n."}
    ]},
  "85": {
    "q": "El bloqueo telef√≥nico se aplica:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Con car√°cter supletorio, en las l√≠neas carentes de sistemas autom√°ticos de bloqueo que determine el AI."},
      {"l": "B", "t": "Con car√°cter supletorio, en l√≠neas equipadas con sistemas autom√°ticos de bloqueo, cuando se produzca una anormalidad en su funcionamiento, o cuando as√≠ lo ordene el Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM o del CTC."},
      {"l": "C", "t": "En l√≠neas con v√≠as banalizadas, con car√°cter supletorio, cuando por necesidad de expedir trenes a contrav√≠a, lo disponga el Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "86": {
    "q": "Para expedir o dar paso a un tren, en BT no es preciso que:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "El cant√≥n de bloqueo est√© libre de trenes."},
      {"l": "B", "t": "Se pida y conceda la v√≠a para el tren que se vaya a expedir."},
      {"l": "C", "t": "Se haya establecido el itinerario de salida."},
      {"l": "D", "t": "Se d√© la orden de marcha con la se√±al de salida."}
    ]},
  "87": {
    "q": "En BT, en estaciones carentes de se√±al de entrada:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "El Responsable de Circulaci√≥n proceder√° al cierre de las se√±ales de salida de la v√≠a o v√≠as hasta haber obtenido la concesi√≥n de v√≠a del Responsable de Circulaci√≥n colateral."},
      {"l": "B", "t": "El Maquinista se detendr√° ante la primera aguja y no la rebasar√° hasta que el Responsable de Circulaci√≥n le autorice el rebase por telefonema."},
      {"l": "C", "t": "El Maquinista circular√° dispuesto a parar ante la se√±al de retroceso y no la rebasar√° hasta que el Responsable de Circulaci√≥n le autorice el rebase por telefonema."},
      {"l": "D", "t": "El Maquinista circular√° dispuesto a parar ante la primera aguja y no la rebasar√° hasta recibir autorizaci√≥n del Responsable de Circulaci√≥n de la estaci√≥n por radiotelefon√≠a."}
    ]},
  "88": {
    "q": "En caso de anormalidad en el funcionamiento de un bloqueo autom√°tico (BA o BLA), ¬øqui√©n autorizar√° expresamente el establecimiento del BT?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Responsable de Circulaci√≥n de la estaci√≥n."},
      {"l": "B", "t": "Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM."},
      {"l": "C", "t": "Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM o del CTC."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "89": {
    "q": "¬øEl establecimiento del BT en una v√≠a condiciona la circulaci√≥n por la otra u otras donde se circule al amparo del BA o BLA?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "S√≠, cuando se establece el BT en una v√≠a afecta a toda la l√≠nea."},
      {"l": "B", "t": "S√≠, porque tanto en v√≠a √∫nica como en doble o m√∫ltiple, el establecimiento del BT se realizar√° de manera simult√°nea para todas las v√≠as."},
      {"l": "C", "t": "No."},
      {"l": "D", "t": "No se puede establecer el BT en una v√≠a mientras se circula al amparo del BA o BLA en las otras."}
    ]},
  "90": {
    "q": "Establecido el BT por anormalidad en el bloqueo autom√°tico, el Responsable de Circulaci√≥n de la estaci√≥n:",
    "a": "B",
    "opts": [
      {"l": "A", "t": "En la estaci√≥n intermedia de un trayecto con BT, cuando se disponga a dar la orden de marcha al Maquinista, le notificar√° lo siguiente: ¬´Circular√° con BT entre ( ) y ( ) por la v√≠a (I, II). No funciona (BA, BLA)¬ª. Dicha notificaci√≥n ser√° √∫nica para cada trayecto entre dos estaciones colaterales."},
      {"l": "B", "t": "En la estaci√≥n intermedia de un trayecto con BT, cuando se disponga a dar la orden de marcha al Maquinista, le notificar√° lo siguiente: ¬´Circular√° con BT entre ( ) y ( ) por la v√≠a (I, II). No funciona (BA, BLA)¬ª. Dicha notificaci√≥n podr√° ser v√°lida para un trayecto que comprenda varias estaciones."},
      {"l": "C", "t": "En la estaci√≥n de transici√≥n hacia un trayecto con BT, cuando se disponga a dar la orden de marcha al Maquinista, le notificar√° lo siguiente: ¬´Circular√° con BT entre ( ) y ( ) por la v√≠a (I, II). No funciona (BA, BLA)¬ª. Dicha notificaci√≥n ser√° √∫nica para cada trayecto entre dos estaciones colaterales."},
      {"l": "D", "t": "En la estaci√≥n de transici√≥n hacia un trayecto con BT, cuando se disponga a dar la orden de marcha al Maquinista, le notificar√° lo siguiente: ¬´Circular√° con BT entre ( ) y ( ) por la v√≠a (I, II). No funciona (BA, BLA)¬ª. Dicha notificaci√≥n podr√° ser v√°lida para un trayecto que comprenda varias estaciones."}
    ]},
  "91": {
    "q": "El Responsable de Circulaci√≥n de una estaci√≥n de transici√≥n hacia un trayecto en el que se ha establecido el BT por anormalidad en el bloqueo autom√°tico, notificar√° al Maquinista: ¬´Circular√° con BT entre ( ) y ( ) por la v√≠a (I, II). No funciona (BA, BLA)¬ª. ¬øQu√© informaci√≥n debe a√±adir a dicha notificaci√≥n?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Estaciones intermedias sin Responsable de Circulaci√≥n, si existen, y cuando proceda: velocidades limitadas, PN con semibarreras enclavadas sin protecci√≥n, etc. Si existen agujas en plena v√≠a, la notificaci√≥n se ampliar√° con el siguiente texto: ¬´Ir√° dispuesto a efectuar parada ante la/s aguja/s del/los km/s ( ) y continuar√° la marcha despu√©s de verificar que est√° bien dispuesto el itinerario a seguir¬ª."},
      {"l": "B", "t": "Estaciones intermedias con Responsable de Circulaci√≥n, si existen, y cuando proceda: velocidades limitadas, PN con semibarreras enclavadas sin protecci√≥n, etc. Si existen agujas en plena v√≠a, la notificaci√≥n se ampliar√° con el siguiente texto: ¬´Ir√° dispuesto a efectuar parada ante la/s aguja/s del/los km/s ( ) y continuar√° la marcha despu√©s de verificar que est√° bien dispuesto el itinerario a seguir¬ª."},
      {"l": "C", "t": "Estaciones intermedias sin Responsable de Circulaci√≥n, si existen, y cuando proceda: velocidades limitadas, PN con semibarreras no enclavadas sin protecci√≥n, etc. Si existen agujas en plena v√≠a, la notificaci√≥n se ampliar√° con el siguiente texto: ¬´Ir√° dispuesto a efectuar parada ante la/s aguja/s del/los km/s ( ) y continuar√° la marcha despu√©s de verificar que est√° bien dispuesto el itinerario a seguir¬ª."},
      {"l": "D", "t": "Esta notificaci√≥n se complementar√° con la orden de marcha."}
    ]},
  "92": {
    "q": "¬øCu√°l ser√° la orden de marcha en la estaci√≥n de transici√≥n hacia un trayecto en el que se ha establecido el BT por anormalidad en el bloqueo autom√°tico?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "La orden de la se√±al de salida y la se√±al de marche el tren."},
      {"l": "B", "t": "La se√±al de marche el tren."},
      {"l": "C", "t": "La orden de la se√±al de salida."},
      {"l": "D", "t": "La orden de la se√±al de salida. Si el Responsable de Circulaci√≥n no la puede abrir, autorizar√° el rebase de la se√±al con marcha a la vista o marcha normal, seg√∫n sea BA o BLA, hasta la siguiente se√±al o estaci√≥n."}
    ]},
  "93": {
    "q": "¬øCu√°l ser√° la orden de marcha en una estaci√≥n intermedia abierta de un trayecto en el que se ha establecido el BT por anormalidad en el bloqueo autom√°tico?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "La orden de la se√±al de salida y la se√±al de marche el tren o se√±al de paso, seg√∫n proceda."},
      {"l": "B", "t": "La se√±al de marche el tren o la se√±al de paso, seg√∫n proceda."},
      {"l": "C", "t": "La orden de la se√±al de salida."},
      {"l": "D", "t": "La orden de la se√±al de salida. Si el Responsable de Circulaci√≥n no la puede abrir, autorizar√° el rebase de la se√±al con marcha a la vista o marcha normal, seg√∫n sea BA o BLA, hasta la siguiente se√±al o estaci√≥n."}
    ]},
  "94": {
    "q": "Circulando en plena v√≠a en un trayecto en el que se ha establecido el BT por anormalidad en el bloqueo autom√°tico, el Maquinista:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Considerar√° existentes las se√±ales intermedias en trayectos con BA, as√≠ como las se√±ales preavanzadas en trayectos con BLA dotados de ellas."},
      {"l": "B", "t": "Considerar√° como comprobaci√≥n suficiente la indicaci√≥n de la se√±al de protecci√≥n, aun cuando sea inexistente a los dem√°s efectos. Si estuviera en indicaci√≥n de parada o apagada, se detendr√° ante la aguja y una vez verificado que su posici√≥n permite el paso, reanudar√° la marcha sin rebasar la velocidad de 10 km/h hasta que el √∫ltimo veh√≠culo la haya franqueado."},
      {"l": "C", "t": "Circular√° a la velocidad de 120 km/h, respetando las velocidades m√°ximas y las limitaciones temporales de velocidad, salvo que el Responsable de Circulaci√≥n le notifique otra velocidad inferior."},
      {"l": "D", "t": "Cuando existan se√±ales intermedias relacionadas con el ASFA, mantendr√° conectado dicho equipo en el trayecto afectado o, si dispone de ASFA Digital, seleccionar√° el modo BT."}
    ]},
  "95": {
    "q": "¬øA qu√© velocidad circular√° el Maquinista en un trayecto en el que se ha establecido el BT por anormalidad en el bloqueo autom√°tico?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Sin exceder la velocidad m√°xima de su tipo de tren, respetando las velocidades m√°ximas y las limitaciones temporales de velocidad, salvo que el Responsable de Circulaci√≥n le notifique otra velocidad inferior."},
      {"l": "B", "t": "Sin exceder la velocidad de 120 km/h, respetando las velocidades m√°ximas y las limitaciones temporales de velocidad, salvo que el Responsable de Circulaci√≥n le notifique otra velocidad inferior."},
      {"l": "C", "t": "Sin exceder la velocidad de 120 km/h, respetando las velocidades m√°ximas y las limitaciones temporales de velocidad, cuando el Responsable de Circulaci√≥n as√≠ se lo notifique."},
      {"l": "D", "t": "Sin exceder la velocidad de 120 km/h, respetando las velocidades m√°ximas y las limitaciones temporales de velocidad, salvo que el Responsable de Circulaci√≥n le notifique otra velocidad superior."}
    ]},
  "96": {
    "q": "Establecido el BT por anormalidad en el bloqueo autom√°tico, en las estaciones el Maquinista:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Se atendr√° a lo que ordene la se√±al avanzada. Si ordenase parada, proceder√° como si diera la indicaci√≥n de anuncio de parada."},
      {"l": "B", "t": "Se atendr√° a lo que ordene la se√±al de entrada."},
      {"l": "C", "t": "Considerar√° inexistentes todas las se√±ales de salida, salvo en estaciones AC cerradas."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "97": {
    "q": "Establecido el BT por anormalidad en el bloqueo autom√°tico, en las estaciones el Maquinista:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Se atendr√° a lo que ordene la se√±al avanzada. Si ordenase parada, se pondr√° en comunicaci√≥n con el Responsable de Circulaci√≥n de la estaci√≥n para que le autorice su rebase."},
      {"l": "B", "t": "Se atendr√° a lo que ordene la se√±al de entrada."},
      {"l": "C", "t": "Considerar√° existentes todas las se√±ales de salida, salvo en estaciones AC cerradas."},
      {"l": "D", "t": "Considerar√° inexistentes todas las se√±ales de salida, salvo en estaciones AC abiertas."}
    ]},
  "98": {
    "q": "Al Maquinista de un tren directo en una estaci√≥n intermedia abierta de un trayecto con BT, ¬øse le dar√° orden de marcha?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "S√≠, con la se√±al de paso."},
      {"l": "B", "t": "S√≠, con la se√±al de salida."},
      {"l": "C", "t": "No es necesaria, se circular√° al amparo del BT."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "99": {
    "q": "Cuando se circule con BT por anormalidad del bloqueo autom√°tico, para autorizar el rebase de una se√±al de salida en indicaci√≥n de parada, se har√°:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Por radiotelefon√≠a."},
      {"l": "B", "t": "Con el telefonema: ¬´Autorizo al tren (n.¬∫ de tren) a rebasar la se√±al (de salida, o su identificaci√≥n) en indicaci√≥n de parada (o apagada) de la estaci√≥n de ( )¬ª."},
      {"l": "C", "t": "Con el telefonema: ¬´Marche el tren (n.¬∫ de tren) hasta (estaci√≥n inmediata) con marcha a la vista hasta la se√±al (primera de bloqueo)¬ª."},
      {"l": "D", "t": "No se autoriza el rebase por telefonema en este caso."}
    ]},
  "100": {
    "q": "En el caso de autorizar el rebase de una se√±al de salida que se encuentre en indicaci√≥n de parada o apagada, cuando se circule con BT por anormalidad del bloqueo autom√°tico, ¬øqu√© condiciones de marcha llevar√° el Maquinista?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Marcha a la vista hasta la siguiente se√±al de bloqueo o de entrada de la estaci√≥n siguiente."},
      {"l": "B", "t": "Marcha normal hasta la siguiente se√±al de bloqueo o de entrada de la estaci√≥n siguiente."},
      {"l": "C", "t": "Marcha a la vista o marcha normal hasta la siguiente se√±al de bloqueo o de entrada de la estaci√≥n siguiente, seg√∫n sea BA o BLA respectivamente."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "101": {
    "q": "En un trayecto con BT por anormalidad del bloqueo autom√°tico, ¬øse podr√° autorizar a un Maquinista el rebase de una se√±al intermedia de bloqueo o de protecci√≥n de una bifurcaci√≥n, PB o PCA?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "No, puesto que se circula al amparo del BT."},
      {"l": "B", "t": "Solo podr√° autorizarlo el Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM."},
      {"l": "C", "t": "El Maquinista no se detendr√° ante estas se√±ales y las considerar√° inexistentes."},
      {"l": "D", "t": "No se le autorizar√° el rebase, sino que el Maquinista las considerar√° inexistentes, salvo las se√±ales de protecci√≥n de agujas en plena v√≠a."}
    ]},
  "102": {
    "q": "Restablecido el funcionamiento del bloqueo autom√°tico, el Responsable de Circulaci√≥n de la estaci√≥n que deba expedir el primer tren:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Notificar√° al Maquinista: ¬´Restablecido el (BA, BLA) entre ( ) y ( ) [por la v√≠a (I, II, etc.)]¬ª."},
      {"l": "B", "t": "No es necesario notificar al Maquinista."},
      {"l": "C", "t": "Solicitar√° autorizaci√≥n al Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM o del CTC."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]}
},
  "4": {

  "103": {
    "q": "¬øA qui√©n se le notificar√° el restablecimiento del bloqueo autom√°tico?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "A todos los Maquinistas de los trenes que circulen por el trayecto."},
      {"l": "B", "t": "Al Maquinista del primer tren que deba expedirse por dicho bloqueo."},
      {"l": "C", "t": "Al Maquinista del primer tren que deba expedirse por dicho bloqueo, de forma verbal."},
      {"l": "D", "t": "No es necesario notificar a los Maquinistas."}
    ]},
  "104": {
    "q": "¬øEn qu√© momento se considera restablecido el bloqueo autom√°tico?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "En cuanto el personal de mantenimiento d√© su conformidad."},
      {"l": "B", "t": "En cuanto se expida el primer tren al amparo del bloqueo autom√°tico."},
      {"l": "C", "t": "En cuanto llegue a la estaci√≥n colateral el primer tren expedido al amparo del bloqueo autom√°tico."},
      {"l": "D", "t": "En cuanto el primer tren expedido al amparo del bloqueo autom√°tico haya despejado el primer cant√≥n."}
    ]},
  "105": {
    "q": "¬øQui√©n autorizar√° el establecimiento de la BTV en trayectos de BA o BLA?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "El Responsable de Circulaci√≥n de la estaci√≥n de transici√≥n."},
      {"l": "B", "t": "El Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM o del CTC."},
      {"l": "C", "t": "El Maquinista."},
      {"l": "D", "t": "El personal de infraestructura."}
    ]},
  "106": {
    "q": "El Maquinista que circule por la v√≠a de la izquierda al amparo de la BTV:",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Considerar√° inexistentes todas las se√±ales de salida, salvo en estaciones cerradas o telemandadas desde otra estaci√≥n o CTC."},
      {"l": "B", "t": "Mantendr√° conectado el sistema ASFA y circular√° sin exceder la velocidad de 120 km/h, salvo que el Responsable de Circulaci√≥n le notifique otra velocidad inferior."},
      {"l": "C", "t": "Considerar√° inexistentes las se√±ales intermedias de BA y las preavanzadas de BLA."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "107": {
    "q": "Si antes de finalizar el recorrido de un trayecto en el que se ha establecido la BTV se pasara a circular por la v√≠a normal:",
    "a": "D",
    "opts": [
      {"l": "A", "t": "No ser√° necesario notificar al Maquinista."},
      {"l": "B", "t": "Se notificar√° al Maquinista lo siguiente: ¬´Circular√° en sentido normal¬ª."},
      {"l": "C", "t": "Se notificar√° al Maquinista lo siguiente: ¬´Restablecido el (BA, BLA) entre ( ) y ( ) [por la v√≠a (I, II, etc.)]¬ª."},
      {"l": "D", "t": "No se puede volver a circular por la v√≠a normal hasta que el √∫ltimo tren expedido haya recorrido todo el trayecto en el que se ha establecido la BTV."}
    ]},
  "108": {
    "q": "Establecida la BTV, el Maquinista que circule en sentido normal:",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Considerar√° inexistentes todas las se√±ales de salida, salvo en estaciones cerradas o telemandadas desde otra estaci√≥n o CTC."},
      {"l": "B", "t": "Mantendr√° conectado el sistema ASFA y circular√° sin exceder la velocidad de 120 km/h, salvo que el Responsable de Circulaci√≥n le notifique otra velocidad inferior."},
      {"l": "C", "t": "Se atendr√° a lo que ordene las se√±ales."},
      {"l": "D", "t": "Todas son correctas."}
    ]},
  "109": {
    "q": "¬øQu√© es una estaci√≥n AC?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Una estaci√≥n con Responsable de Circulaci√≥n presente pero que no interviene en el bloqueo."},
      {"l": "B", "t": "Una estaci√≥n que puede estar abierta o cerrada a efectos de la circulaci√≥n, interviniendo en el bloqueo √∫nicamente cuando est√° abierta."},
      {"l": "C", "t": "Una estaci√≥n telemandada desde el CTC."},
      {"l": "D", "t": "Una estaci√≥n que solo permite el cruce de trenes."}
    ]},
  "110": {
    "q": "¬øQui√©n tiene la facultad de abrir o cerrar una estaci√≥n AC?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "El Maquinista."},
      {"l": "B", "t": "El Responsable de Circulaci√≥n de la propia estaci√≥n."},
      {"l": "C", "t": "El Responsable de Circulaci√≥n de la Banda de Regulaci√≥n del PM."},
      {"l": "D", "t": "El AI mediante Consigna."}
    ]},
  "111": {
    "q": "¬øQu√© indica el cartel√≥n con la letra ¬´C¬ª en el eje de una se√±al de entrada o de salida?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Estaci√≥n con Control de velocidad."},
      {"l": "B", "t": "Estaci√≥n que puede estar Cerrada a efectos de la circulaci√≥n."},
      {"l": "C", "t": "Estaci√≥n con Cambios autom√°ticos."},
      {"l": "D", "t": "Estaci√≥n de Cruce."}
    ]},
  "112": {
    "q": "Cuando una estaci√≥n AC est√© cerrada, ¬øc√≥mo se consideran sus se√±ales de entrada y salida?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Como se√±ales absolutas."},
      {"l": "B", "t": "Como se√±ales permisivas."},
      {"l": "C", "t": "Como inexistentes."},
      {"l": "D", "t": "Como se√±ales de bloqueo."}
    ]},
  "113": {
    "q": "¬øEn qu√© bloqueos pueden existir estaciones AC?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "En todos los bloqueos autom√°ticos."},
      {"l": "B", "t": "Solo en BAU y BAB."},
      {"l": "C", "t": "Solo en BLAU y BLAB."},
      {"l": "D", "t": "En bloqueos autom√°ticos (BAU, BAB, BLAU, BLAB) y en BT."}
    ]},
   "114": {
    "q": "¬øPuede una estaci√≥n AC estar cerrada si no funciona el BA o BLA?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "S√≠, siempre que se establezca el BT."},
      {"l": "B", "t": "No, deber√° estar abierta para intervenir en el BT."},
      {"l": "C", "t": "Solo si lo autoriza el PM."},
      {"l": "D", "t": "Solo si dispone de telemando."}
    ]},
  "115": {
    "q": "En una estaci√≥n AC cerrada, ¬øqu√© indica el indicador luminoso EA/EC?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Entrada Autorizada / Entrada Condicional."},
      {"l": "B", "t": "Estaci√≥n Abierta / Estaci√≥n Cerrada."},
      {"l": "C", "t": "Estacionamiento Autorizado / Estacionamiento Cancelado."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "116": {
    "q": "¬øC√≥mo proceder√° el Maquinista al llegar a una estaci√≥n AC cerrada?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "De igual forma que si se tratara de una estaci√≥n abierta, por ser estaci√≥n AC."},
      {"l": "B", "t": "De igual forma que si se tratara de plena v√≠a, tratando las se√±ales de la estaci√≥n como se√±ales intermedias permisivas."},
      {"l": "C", "t": "Deber√° comprobar la posible presencia de alg√∫n cartel√≥n C o indicador luminoso EA/EC, si la estaci√≥n dispone de ellos, o en su defecto, la presentaci√≥n de la se√±al de paso cuando proceda."},
      {"l": "D", "t": "Deber√° comprobar la posible presencia de alg√∫n cartel√≥n C o indicador luminoso EA/EC, si la estaci√≥n dispone de ellos. En caso contrario, efectuar√° detenci√≥n inmediata."}
    ]},
  "117": {
    "q": "¬øQu√© debe asegurar el Responsable de Circulaci√≥n antes de cerrar una estaci√≥n AC?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Que no hay trenes en el trayecto."},
      {"l": "B", "t": "Que las agujas est√°n bien dispuestas para la v√≠a directa y los itinerarios est√°n establecidos y bloqueados."},
      {"l": "C", "t": "Que ha comunicado el cierre a todas las estaciones de la l√≠nea."},
      {"l": "D", "t": "Que ha desconectado el suministro el√©ctrico de la estaci√≥n."}
    ]},
  "118": {
    "q": "Cuando una estaci√≥n AC se abre, ¬øqui√©n es el primer tren al que se le notifica la apertura?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Al primer tren que pase por la estaci√≥n despu√©s de su apertura."},
      {"l": "B", "t": "Al Maquinista de todos los trenes que se encuentren en las estaciones colaterales."},
      {"l": "C", "t": "Al Maquinista del primer tren que deba expedirse hacia la estaci√≥n abierta."},
      {"l": "D", "t": "No es necesaria tal notificaci√≥n."}
    ]},
  "119": {
    "q": "¬øQu√© es un Puesto de Bloqueo (PB)?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Una estaci√≥n peque√±a."},
      {"l": "B", "t": "Una dependencia de la l√≠nea que interviene en el bloqueo pero que no dispone de v√≠as de apartado."},
      {"l": "C", "t": "Un lugar en plena v√≠a donde se puede estacionar un tren."},
      {"l": "D", "t": "Una dependencia que solo existe en l√≠neas de alta velocidad."}
    ]},
  "120": {
    "q": "¬øCu√°l es la funci√≥n principal de un PB?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Permitir el cruce de trenes."},
      {"l": "B", "t": "Dividir un cant√≥n de bloqueo largo en otros m√°s cortos para aumentar la capacidad de la l√≠nea."},
      {"l": "C", "t": "Controlar el acceso a una derivaci√≥n particular."},
      {"l": "D", "t": "Servir de punto de socorro para trenes averiados."}
    ]},
  "121": {
    "q": "¬øPuede un PB estar telemandado?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "No, siempre debe haber un Responsable de Circulaci√≥n."},
      {"l": "B", "t": "S√≠, desde una estaci√≥n colateral o desde el CTC."},
      {"l": "C", "t": "Solo en l√≠neas de v√≠a √∫nica."},
      {"l": "D", "t": "Solo si dispone de se√±ales luminosas."}
    ]},
  "122": {
    "q": "¬øQu√© es un Punto de Cantonamiento Autom√°tico (PCA)?",
    "a": "B",
    "opts": [
      {"l": "A", "t": "Una estaci√≥n con se√±ales autom√°ticas."},
      {"l": "B", "t": "Una instalaci√≥n en plena v√≠a, sin intervenci√≥n de personal, que divide el trayecto en dos cantones de bloqueo mediante se√±ales autom√°ticas."},
      {"l": "C", "t": "Un punto donde el Maquinista debe comunicar su posici√≥n."},
      {"l": "D", "t": "Un PN protegido con se√±ales."}
    ]},
  "123": {
    "q": "¬øEn qu√© bloqueos pueden existir PCA?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Solo en BA."},
      {"l": "B", "t": "Solo en BLA."},
      {"l": "C", "t": "En bloqueos autom√°ticos (BA, BLA, BSL, BCA)."},
      {"l": "D", "t": "Solo en l√≠neas de alta velocidad."}
    ]},
  "124": {
    "q": "¬øC√≥mo se denominan las se√±ales que protegen un PCA?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Se√±ales de entrada y salida."},
      {"l": "B", "t": "Se√±ales de bloqueo."},
      {"l": "C", "t": "Se√±ales avanzadas."},
      {"l": "D", "t": "Se√±ales de protecci√≥n de PCA."}
    ]},
  "125": {
    "q": "¬øQu√© es un Puesto de Cantonamiento (PC)?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Lo mismo que un PB."},
      {"l": "B", "t": "Una dependencia en plena v√≠a, con personal, que interviene en el BT para dividir un cant√≥n."},
      {"l": "C", "t": "Una estaci√≥n de paso sin paradas."},
      {"l": "D", "t": "Un punto donde se sit√∫a un agente para dar la se√±al de paso."}
    ]},
  "126": {
    "q": "¬øCu√°ndo se utiliza un PC?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Siempre que haya mucho tr√°fico."},
      {"l": "B", "t": "Exclusivamente en el BT, cuando sea necesario aumentar la capacidad de la l√≠nea."},
      {"l": "C", "t": "En el BA cuando fallan las se√±ales."},
      {"l": "D", "t": "Solo para trenes de mercanc√≠as."}
    ]},
  "127": {
    "q": "¬øC√≥mo se realiza el bloqueo entre una estaci√≥n y un PC?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Mediante se√±ales luminosas."},
      {"l": "B", "t": "Mediante telefonemas, igual que entre estaciones colaterales."},
      {"l": "C", "t": "Mediante banderines y faroles."},
      {"l": "D", "t": "No existe bloqueo propiamente dicho, se circula con marcha a la vista."}
    ]},
  "128": {
    "q": "¬øQu√© es un Puesto de Banalizaci√≥n (PBa)?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Un lugar donde los trenes pueden cambiar de v√≠a en l√≠neas de v√≠a doble."},
      {"l": "B", "t": "Una dependencia en plena v√≠a equipada con escapes que permite pasar de una v√≠a a otra en ambos sentidos."},
      {"l": "C", "t": "Una estaci√≥n terminal."},
      {"l": "D", "t": "Un tramo de v√≠a donde se puede circular por la izquierda."}
    ]},
  "129": {
    "q": "¬øEn qu√© tipos de v√≠a existen los PBa?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "En v√≠a √∫nica."},
      {"l": "B", "t": "En v√≠a doble con bloqueos para circulaci√≥n en ambos sentidos (BAB, BLAB, BCA)."},
      {"l": "C", "t": "Solo en l√≠neas de alta velocidad."},
      {"l": "D", "t": "En todas las v√≠as dobles."}
    ]},
  "130": {
    "q": "¬øQui√©n gobierna las agujas y se√±ales de un PBa?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Un Responsable de Circulaci√≥n presente en el mismo."},
      {"l": "B", "t": "El Maquinista mediante un mando a distancia."},
      {"l": "C", "t": "El Responsable de Circulaci√≥n de una estaci√≥n colateral o del CTC."},
      {"l": "D", "t": "Son autom√°ticas y se accionan por el paso del tren."}
    ]},
  "131": {
    "q": "¬øQu√© se√±ales protegen un PBa?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Se√±ales de entrada y salida."},
      {"l": "B", "t": "Se√±ales de bloqueo."},
      {"l": "C", "t": "Se√±ales avanzadas y de entrada."},
      {"l": "D", "t": "Se√±ales de protecci√≥n de PBa."}
    ]},
  "132": {
    "q": "¬øQu√© se entiende por \"trayecto\" a efectos de bloqueo?",
    "a": "D",
    "opts": [
      {"l": "A", "t": "Toda la l√≠nea ferroviaria."},
      {"l": "B", "t": "El tramo de v√≠a comprendido entre dos estaciones colaterales abiertas."},
      {"l": "C", "t": "La distancia entre dos se√±ales de parada."},
      {"l": "D", "t": "El recorrido total de un tren."}
    ]},
  "133": {
    "q": "¬øQu√© es una Bifurcaci√≥n en plena v√≠a?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Un cruce de dos l√≠neas en el mismo nivel."},
      {"l": "B", "t": "Un punto de la l√≠nea donde una v√≠a se divide en dos o m√°s, situado fuera de las estaciones."},
      {"l": "C", "t": "Una v√≠a muerta."},
      {"l": "D", "t": "Un cambio de agujas dentro de una estaci√≥n."}
    ]},
  "134": {
    "q": "¬øC√≥mo se establecen las condiciones de circulaci√≥n en las bifurcaciones en plena v√≠a?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Por el RCF de forma general."},
      {"l": "B", "t": "Por el Responsable de Circulaci√≥n del CTC."},
      {"l": "C", "t": "Por Consigna de la Banda de Regulaci√≥n del PM."},
      {"l": "D", "t": "Por Consigna del AI."}
    ]},
  "135": {
    "q": "¬øCu√°l es el fin de un puesto de bloqueo?",
    "a": "A",
    "opts": [
      {"l": "A", "t": "Regular la circulaci√≥n de los trenes mediante su apartado y estacionamiento."},
      {"l": "B", "t": "Permitir la banalizaci√≥n de trenes en v√≠as banalizadas."},
      {"l": "C", "t": "Dividir el cantonamiento de un trayecto entre dos estaciones colaterales."},
      {"l": "D", "t": "Ninguna es correcta."}
    ]},
  "136": {
    "q": "¬øC√≥mo queda garantizada la relaci√≥n de dependencia entre estaciones en BEM?",
    "a": "C",
    "opts": [
      {"l": "A", "t": "Mediante acuerdos bilaterales entre sus Responsables de Circulaci√≥n para concertar la circulaci√≥n de trenes entre ambas."},
      {"l": "B", "t": "Mediante petici√≥n y concesi√≥n de v√≠a mediante BOI."},
      {"l": "C", "t": "Mediante petici√≥n y concesi√≥n o toma de v√≠a mediante cuadro el√©ctrico-manual."},
      {"l": "D", "t": "Por la propia naturaleza de la instalaci√≥n."}
    ]}
  }
 };

  let currentPart = 1;
  let respuestasVisibles = false;
  const LS_PREFIX = 'rcf-libro1-part-';

  // Load state from localStorage
  function loadState(part) {
    try {
      return JSON.parse(localStorage.getItem(LS_PREFIX + part)) || {};
    } catch {
      return {};
    }
  }

  // Save state to localStorage
  function saveState(part, state) {
    localStorage.setItem(LS_PREFIX + part, JSON.stringify(state));
  }

  // Switch between parts
  function switchPart(part) {
    currentPart = part;
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById('tab_' + part).classList.add('active');
    generarTest();
    // window.scrollTo({top: 0, behavior: 'smooth'});
  }

  // Generate test for current part
  function generarTest() {
    const container = document.getElementById('questionsContainer');
    container.innerHTML = '';
    
    const partData = testData[currentPart];
    if (!partData) return;
    
    const state = loadState(currentPart);
    
    Object.keys(partData).forEach(qid => {
      const q = partData[qid];
      const card = document.createElement('div');
      card.className = 'card question';
      card.dataset.qid = qid;
      
      let opcionesHTML = '';
      q.opts.forEach(opt => {
        const checked = state[qid] === opt.l ? 'checked' : '';
        opcionesHTML += `
          <label class="option">
            <input type="radio" name="q${qid}" value="${opt.l}" ${checked} />
            <div><b>${opt.l})</b> ${opt.t}</div>
          </label>
        `;
      });

      card.innerHTML = `
        <span class="q-number">Pregunta ${qid}</span>
        <div class="q-title">${q.q}</div>
        <div class="options">${opcionesHTML}</div>
        <div class="answer-key">‚úì Respuesta correcta: <b>${q.a}</b></div>
        <div class="feedback"></div>
      `;
      
      container.appendChild(card);
    });

    bindRadios();
    updateProgress();
  }
  
  function bindRadios() {
    document.querySelectorAll('input[type=radio]').forEach(radio => {
      radio.addEventListener('change', updateProgress);
    });
  }
  
    // Update progress bar
  function updateProgress() {
    const partData = testData[currentPart];
    const total = Object.keys(partData).length;
    const answered = document.querySelectorAll('input[type=radio]:checked').length;
    const percentage = (answered / total) * 100;
    document.getElementById('progressBar').style.width = percentage + '%';
    
    // Save current answers
    const state = {};
    document.querySelectorAll('.question').forEach(card => {
      const qid = card.dataset.qid;
      const selected = card.querySelector('input[type=radio]:checked');
      if (selected) {
        state[qid] = selected.value;
      }
    });
    saveState(currentPart, state);
  }

  // Grade the test
  window.calificar = function() {
    const partData = testData[currentPart];
    let correctas = 0;
    let incorrectas = 0;
    let sinResponder = 0;
    const total = Object.keys(partData).length;
    
    document.querySelectorAll('.question').forEach(card => {
      const qid = card.dataset.qid;
      const correcta = partData[qid].a;
      const seleccionada = card.querySelector('input[type=radio]:checked');
      
      card.querySelectorAll('.option').forEach(o => o.classList.remove('correct','incorrect'));
      
      if (seleccionada) {
        const letra = seleccionada.value;
        if (letra === correcta) {
          correctas++;
          seleccionada.closest('.option').classList.add('correct');
          card.querySelector('.feedback').textContent = '‚úî ¬°Correcto!';
          card.querySelector('.feedback').style.color = 'var(--ok)';
        } else {
          incorrectas++;
          seleccionada.closest('.option').classList.add('incorrect');
          card.querySelector('.feedback').innerHTML = `‚úñ Incorrecto ¬∑ La correcta es: <b>${correcta}</b>`;
          card.querySelector('.feedback').style.color = 'var(--bad)';
          const corr = card.querySelector(`input[value="${correcta}"]`);
          if (corr) corr.closest('.option').classList.add('correct');
        }
      } else {
        sinResponder++;
        card.querySelector('.feedback').textContent = '‚ö† Sin responder';
        card.querySelector('.feedback').style.color = 'var(--warning)';
      }
    });
    
    const porcentaje = Math.round((correctas / total) * 100);
    const aprobado = porcentaje >= 50;
    
    document.getElementById('score').textContent = `${correctas} / ${total} (${porcentaje}%)`;
    document.getElementById('score').style.color = aprobado ? 'var(--ok)' : 'var(--bad)';
    
    document.getElementById('scoreDetails').innerHTML = `
      ‚úî ${correctas} correctas ¬∑ ‚úñ ${incorrectas} incorrectas ¬∑ ‚ö† ${sinResponder} sin responder
    `;
    
   // window.scrollTo({top: 0, behavior: 'smooth'});
  };

  // Reset the test
  window.reiniciar = function() {
    if (!confirm('¬øReiniciar respuestas de esta parte?')) return;
    
    document.querySelectorAll('input[type=radio]').forEach(r => r.checked = false);
    document.querySelectorAll('.option').forEach(o => o.classList.remove('correct','incorrect'));
    document.querySelectorAll('.feedback').forEach(f => {f.textContent=''; f.removeAttribute('style')});
    document.getElementById('score').textContent = '‚Äî';
    document.getElementById('score').removeAttribute('style');
    document.getElementById('scoreDetails').textContent = '';
    document.getElementById('progressBar').style.width = '0%';
    saveState(currentPart, {});
    window.scrollTo({top: 0, behavior: 'smooth'});
  };

  // Toggle answer visibility
  window.toggleRespuestas = function(btn) {
    respuestasVisibles = !respuestasVisibles;
    document.body.classList.toggle('show-answers', respuestasVisibles);
    btn.textContent = respuestasVisibles ? 'üôà Ocultar respuestas' : 'üëÅÔ∏è Ver respuestas';
    
    if (respuestasVisibles) {
      const partData = testData[currentPart];
      document.querySelectorAll('.question').forEach(card => {
        const qid = card.dataset.qid;
        const correcta = partData[qid].a;
        card.querySelectorAll('.option').forEach(o => o.classList.remove('correct'));
        const corr = card.querySelector(`input[value="${correcta}"]`);
        if (corr) corr.closest('.option').classList.add('correct');
      });
    } else {
      document.querySelectorAll('.option').forEach(o => o.classList.remove('correct'));
    }
  };

  // Initialize tabs
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      switchPart(parseInt(tab.dataset.part));
    });
  });

  // Initialize on load
  window.addEventListener('load', () => {
    document.getElementById('tab_1').classList.add('active');
    generarTest();
  });
// Scroll to top button functionality
const scrollTopBtn = document.getElementById('scrollTopBtn');

// Show/hide button based on scroll position
window.addEventListener('scroll', () => {
  if (window.pageYOffset > 300) {
    scrollTopBtn.classList.add('visible');
  } else {
    scrollTopBtn.classList.remove('visible');
  }
});

// Smooth scroll to top on click
scrollTopBtn.addEventListener('click', () => {
  window.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
});
})();
</script>
</body>
</html>
